{
  "BIP": "382",
  "Layer": "Applications",
  "Title": "Segwit Output Script Descriptors",
  "Author": "Pieter Wuille <pieter@wuille.net>",
  "Comments-Summary": "No comments yet.",
  "Comments-URI": "https://github.com/bitcoin/bips/wiki/Comments:BIP-0382",
  "Status": "Draft",
  "Type": "Informational",
  "Created": "2021-06-27",
  "License": "BSD-2-Clause",
  "sections": [
    {
      "header": "Abstract",
      "content": "This document specifies `wpkh()`, and `wsh()` output script descriptors.\n`wpkh()` descriptors take a key and produces a P2WPKH output script.\n`wsh()` descriptors take a script and produces a P2WSH output script."
    },
    {
      "header": "Copyright",
      "content": "This BIP is licensed under the BSD 2-clause license."
    },
    {
      "header": "Motivation",
      "content": "Segregated Witness added 2 additional standard output script formats:\nP2WPKH and P2WSH. These expressions allow specifying those formats as a\ndescriptor."
    },
    {
      "header": "Specification",
      "content": "Two new script expressions are defined: `wpkh()`, and `wsh()`."
    },
    {
      "header": "`wpkh()`",
      "content": "The `wpkh(KEY)` expression can be used as a top level expression, or\ninside of a `sh()` descriptor. It takes a single key expression as an\nargument and produces a P2WPKH output script. Only keys which are/has\ncompressed public keys can be contained in a `wpkh()` expression.\n\nThe output script produced is:\n\nOP_0 <KEY_hash160>"
    },
    {
      "header": "`wsh()`",
      "content": "The `wsh(SCRIPT)` expression can be used as a top level expression, or\ninside of a `sh()` descriptor. It takes a single script expression as an\nargument and produces a P2WSH output script. `wsh()` expressions also\ncreate a witnessScript which is required in order to spend outputs which\nuse its output script. This redeemScript is the output script produced\nby the `SCRIPT` argument to `wsh()`. Any key expression found in any\nscript expression contained by a `wsh()` expression must only produce\ncompressed public keys.\n\nThe output script produced is:\n\nOP_0 <SCRIPT_sha256>"
    },
    {
      "header": "Test Vectors {#test_vectors}",
      "content": "TBD"
    },
    {
      "header": "Backwards Compatibility {#backwards_compatibility}",
      "content": "`wpkh()`, and `wsh()` descriptors use the format and general operation\nspecified in [380](bip-0380.mediawiki \"wikilink\"). As these are a wholly\nnew descriptors, they are not compatible with any implementation.\nHowever the scripts produced are standard scripts so existing software\nare likely to be familiar with them."
    },
    {
      "header": "Reference Implementation {#reference_implementation}",
      "content": "`wpkh()`, and `wsh()` descriptors have been implemented in Bitcoin Core\nsince version 0.17."
    }
  ]
}