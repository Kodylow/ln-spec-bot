{
  "BIP": "143",
  "Layer": "Consensus (soft fork)",
  "Title": "Transaction Signature Verification for Version 0 Witness Program",
  "Author": "Johnson Lau <jl2012@xbt.hk>",
  "Comments-Summary": "No comments yet.",
  "Comments-URI": "https://github.com/bitcoin/bips/wiki/Comments:BIP-0143",
  "Status": "Final",
  "Type": "Standards Track",
  "Created": "2016-01-03",
  "License": "PD",
  "sections": [
    {
      "header": "Abstract",
      "content": "This proposal defines a new transaction digest algorithm for signature\nverification in version 0 witness program, in order to minimize\nredundant data hashing in verification, and to cover the input value by\nthe signature."
    },
    {
      "header": "Motivation",
      "content": "There are 4 ECDSA signature verification codes in the original Bitcoin\nscript system: `CHECKSIG`, `CHECKSIGVERIFY`, `CHECKMULTISIG`,\n`CHECKMULTISIGVERIFY` (\"sigops\"). According to the sighash type (`ALL`,\n`NONE`, `SINGLE`, `ANYONECANPAY`), a transaction digest is generated\nwith a double SHA256 of a serialized subset of the transaction, and the\nsignature is verified against this digest with a given public key. The\ndetailed procedure is described in a Bitcoin Wiki article. [^1]\n\nUnfortunately, there are at least 2 weaknesses in the original\nSignatureHash transaction digest algorithm:\n\n-   For the verification of each signature, the amount of data hashing\nis proportional to the size of the transaction. Therefore, data\nhashing grows in O(n^2^) as the number of sigops in a transaction\nincreases. While a 1 MB block would normally take 2 seconds to\nverify with an average computer in 2015, a 1MB transaction with 5569\nsigops may take 25 seconds to verify. This could be fixed by\noptimizing the digest algorithm by introducing some reusable\n\"midstate\", so the time complexity becomes O(n). [^2][^3][^4]\n-   The algorithm does not involve the amount of Bitcoin being spent by\nthe input. This is usually not a problem for online network nodes as\nthey could request for the specified transaction to acquire the\noutput value. For an offline transaction signing device (\\\"cold\nwallet\\\"), however, the unknowing of input amount makes it\nimpossible to calculate the exact amount being spent and the\ntransaction fee. To cope with this problem a cold wallet must also\nacquire the full transaction being spent, which could be a big\nobstacle in the implementation of lightweight, air-gapped wallet. By\nincluding the input value of part of the transaction digest, a cold\nwallet may safely sign a transaction by learning the value from an\nuntrusted source. In the case that a wrong value is provided and\nsigned, the signature would be invalid and no funding might be lost.\n[^5]\n\nDeploying the aforementioned fixes in the original script system is not\na simple task. That would be either a hardfork, or a softfork for new\nsigops without the ability to remove or insert stack items. However, the\nintroduction of segregated witness softfork offers an opportunity to\ndefine a different set of script semantics without disrupting the\noriginal system, as the unupgraded nodes would always consider such a\ntransaction output is spendable by arbitrary signature or no signature\nat all. [^6]"
    },
    {
      "header": "Specification",
      "content": "A new transaction digest algorithm is defined, but only applicable to\nsigops in version 0 witness program:\n\n`\u00a0Double\u00a0SHA256\u00a0of\u00a0the\u00a0serialization\u00a0of:`\\\n`\u00a0\u00a0\u00a0\u00a01.\u00a0nVersion\u00a0of\u00a0the\u00a0transaction\u00a0(4-byte\u00a0little\u00a0endian)`\\\n`\u00a0\u00a0\u00a0\u00a02.\u00a0hashPrevouts\u00a0(32-byte\u00a0hash)`\\\n`\u00a0\u00a0\u00a0\u00a03.\u00a0hashSequence\u00a0(32-byte\u00a0hash)`\\\n`\u00a0\u00a0\u00a0\u00a04.\u00a0outpoint\u00a0(32-byte\u00a0hash\u00a0+\u00a04-byte\u00a0little\u00a0endian)\u00a0`\\\n`\u00a0\u00a0\u00a0\u00a05.\u00a0scriptCode\u00a0of\u00a0the\u00a0input\u00a0(serialized\u00a0as\u00a0scripts\u00a0inside\u00a0CTxOuts)`\\\n`\u00a0\u00a0\u00a0\u00a06.\u00a0value\u00a0of\u00a0the\u00a0output\u00a0spent\u00a0by\u00a0this\u00a0input\u00a0(8-byte\u00a0little\u00a0endian)`\\\n`\u00a0\u00a0\u00a0\u00a07.\u00a0nSequence\u00a0of\u00a0the\u00a0input\u00a0(4-byte\u00a0little\u00a0endian)`\\\n`\u00a0\u00a0\u00a0\u00a08.\u00a0hashOutputs\u00a0(32-byte\u00a0hash)`\\\n`\u00a0\u00a0\u00a0\u00a09.\u00a0nLocktime\u00a0of\u00a0the\u00a0transaction\u00a0(4-byte\u00a0little\u00a0endian)`\\\n`\u00a0\u00a0\u00a010.\u00a0sighash\u00a0type\u00a0of\u00a0the\u00a0signature\u00a0(4-byte\u00a0little\u00a0endian)`\n\nSemantics of the original sighash types remain unchanged, except the\nfollowings:\n\n1.  The way of serialization is changed;\n2.  All sighash types commit to the amount being spent by the signed\ninput;\n3.  `FindAndDelete` of the signature is not applied to the `scriptCode`;\n4.  `OP_CODESEPARATOR`(s) after the last executed `OP_CODESEPARATOR` are\nnot removed from the `scriptCode` (the last executed\n`OP_CODESEPARATOR` and any script before it are always removed);\n5.  `SINGLE` does not commit to the input index. When `ANYONECANPAY` is\nnot set, the semantics are unchanged since `hashPrevouts` and\n`outpoint` together implictly commit to the input index. When\n`SINGLE` is used with `ANYONECANPAY`, omission of the index\ncommitment allows permutation of the input-output pairs, as long as\neach pair is located at an equivalent index.\n\nThe items 1, 4, 7, 9, 10 have the same meaning as the original\nalgorithm. [^7]\n\nThe item 5:\n\n-   For `P2WPKH` witness program, the `scriptCode` is\n`0x1976a914{20-byte-pubkey-hash}88ac`.\n-   For `P2WSH` witness program,\n-   if the `witnessScript` does not contain any `OP_CODESEPARATOR`,\nthe `scriptCode` is the `witnessScript` serialized as scripts\ninside `CTxOut`.\n-   if the `witnessScript` contains any `OP_CODESEPARATOR`, the\n`scriptCode` is the `witnessScript` but removing everything up\nto and including the last executed `OP_CODESEPARATOR` before the\nsignature checking opcode being executed, serialized as scripts\ninside `CTxOut`. (The exact semantics is demonstrated in the\nexamples below)\n\nThe item 6 is a 8-byte value of the amount of bitcoin spent in this\ninput.\n\n`hashPrevouts`:\n\n-   If the `ANYONECANPAY` flag is not set, `hashPrevouts` is the double\nSHA256 of the serialization of all input outpoints;\n-   Otherwise, `hashPrevouts` is a `uint256` of `0x0000......0000`.\n\n`hashSequence`:\n\n-   If none of the `ANYONECANPAY`, `SINGLE`, `NONE` sighash type is set,\n`hashSequence` is the double SHA256 of the serialization of\n`nSequence` of all inputs;\n-   Otherwise, `hashSequence` is a `uint256` of `0x0000......0000`.\n\n`hashOutputs`:\n\n-   If the sighash type is neither `SINGLE` nor `NONE`, `hashOutputs` is\nthe double SHA256 of the serialization of all output amount (8-byte\nlittle endian) with `scriptPubKey` (serialized as scripts inside\nCTxOuts);\n-   If sighash type is `SINGLE` and the input index is smaller than the\nnumber of outputs, `hashOutputs` is the double SHA256 of the output\namount with `scriptPubKey` of the same index as the input;\n-   Otherwise, `hashOutputs` is a `uint256` of `0x0000......0000`.[^8]\n\nThe `hashPrevouts`, `hashSequence`, and `hashOutputs` calculated in an\nearlier verification may be reused in other inputs of the same\ntransaction, so that the time complexity of the whole hashing process\nreduces from O(n^2^) to O(n).\n\nRefer to the reference implementation, reproduced below, for the precise\nalgorithm:\n\n``` cpp\nuint256 hashPrevouts;\nuint256 hashSequence;\nuint256 hashOutputs;\n\nif (!(nHashType & SIGHASH_ANYONECANPAY)) {\nCHashWriter ss(SER_GETHASH, 0);\nfor (unsigned int n = 0; n < txTo.vin.size(); n++) {\nss << txTo.vin[n].prevout;\n}\nhashPrevouts = ss.GetHash();\n}\n\nif (!(nHashType & SIGHASH_ANYONECANPAY) && (nHashType & 0x1f) != SIGHASH_SINGLE && (nHashType & 0x1f) != SIGHASH_NONE) {\nCHashWriter ss(SER_GETHASH, 0);\nfor (unsigned int n = 0; n < txTo.vin.size(); n++) {\nss << txTo.vin[n].nSequence;\n}\nhashSequence = ss.GetHash();\n}\n\nif ((nHashType & 0x1f) != SIGHASH_SINGLE && (nHashType & 0x1f) != SIGHASH_NONE) {\nCHashWriter ss(SER_GETHASH, 0);\nfor (unsigned int n = 0; n < txTo.vout.size(); n++) {\nss << txTo.vout[n];\n}\nhashOutputs = ss.GetHash();\n} else if ((nHashType & 0x1f) == SIGHASH_SINGLE && nIn < txTo.vout.size()) {\nCHashWriter ss(SER_GETHASH, 0);\nss << txTo.vout[nIn];\nhashOutputs = ss.GetHash();\n}\n\nCHashWriter ss(SER_GETHASH, 0);\n// Version\nss << txTo.nVersion;\n// Input prevouts/nSequence (none/all, depending on flags)\nss << hashPrevouts;\nss << hashSequence;\n// The input being signed (replacing the scriptSig with scriptCode + amount)\n// The prevout may already be contained in hashPrevout, and the nSequence\n// may already be contain in hashSequence.\nss << txTo.vin[nIn].prevout;\nss << static_cast<const CScriptBase&>(scriptCode);\nss << amount;\nss << txTo.vin[nIn].nSequence;\n// Outputs (none/one/all, depending on flags)\nss << hashOutputs;\n// Locktime\nss << txTo.nLockTime;\n// Sighash type\nss << nHashType;\n\nreturn ss.GetHash();\n```"
    },
    {
      "header": "Restrictions on public key type {#restrictions_on_public_key_type}",
      "content": "As a default policy, only compressed public keys are accepted in\n`P2WPKH` and `P2WSH`. Each public key passed to a sigop inside version 0\nwitness program must be a compressed key: the first byte MUST be either\n`0x02` or `0x03`, and the size MUST be 33 bytes. Transactions that break\nthis rule will not be relayed or mined by default.\n\nSince this policy is preparation for a future softfork proposal, to\navoid potential future funds loss, users MUST NOT use uncompressed keys\nin version 0 witness programs."
    },
    {
      "header": "Example",
      "content": "To ensure consistency in consensus-critical behaviour, developers should\ntest their implementations against all the tests below. More tests\nrelated to this proposal could be found under\n<https://github.com/bitcoin/bitcoin/tree/master/src/test/data> ."
    },
    {
      "header": "Native P2WPKH {#native_p2wpkh}",
      "content": "`\u00a0The\u00a0following\u00a0is\u00a0an\u00a0unsigned\u00a0transaction:`\\\n`\u00a0\u00a0\u00a00100000002fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f0000000000eeffffffef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a0100000000ffffffff02202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac11000000`\\\n`\u00a0\u00a0\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f\u00a000000000\u00a000\u00a0eeffffff`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a\u00a001000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0202cb20600000000\u00a01976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a09093510d00000000\u00a01976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a011000000`\\\n`\u00a0`\\\n`\u00a0The\u00a0first\u00a0input\u00a0comes\u00a0from\u00a0an\u00a0ordinary\u00a0P2PK:`\\\n`\u00a0\u00a0\u00a0scriptPubKey\u00a0:\u00a02103c9f4836b9a4f77fc0d81f7bcb01b7f1b35916864b9476c241ce9fc198bd25432ac\u00a0value:\u00a06.25`\\\n`\u00a0\u00a0\u00a0private\u00a0key\u00a0\u00a0:\u00a0bbc27228ddcb9209d7fd6f36b02f7dfa6252af40bb2f1cbc7a557da8027ff866`\\\n`\u00a0\u00a0\u00a0`\\\n`\u00a0The\u00a0second\u00a0input\u00a0comes\u00a0from\u00a0a\u00a0P2WPKH\u00a0witness\u00a0program:`\\\n`\u00a0\u00a0\u00a0scriptPubKey\u00a0:\u00a000141d0f172a0ecb48aee1be1f2687d2963ae33f71a1,\u00a0value:\u00a06`\\\n`\u00a0\u00a0\u00a0private\u00a0key\u00a0\u00a0:\u00a0619c335025c7f4012e556c2a58b2506e30b8511b53ade95ea316fd8c3286feb9`\\\n`\u00a0\u00a0\u00a0public\u00a0key\u00a0\u00a0\u00a0:\u00a0025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee6357`\\\n`\u00a0\u00a0\u00a0`\\\n`\u00a0To\u00a0sign\u00a0it\u00a0with\u00a0a\u00a0nHashType\u00a0of\u00a01\u00a0(SIGHASH_ALL):`\\\n`\u00a0`\\\n`\u00a0hashPrevouts:`\\\n`\u00a0\u00a0\u00a0dSHA256(fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f00000000ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a01000000)`\\\n`\u00a0=\u00a096b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd37`\\\n`\u00a0`\\\n`\u00a0hashSequence:`\\\n`\u00a0\u00a0\u00a0dSHA256(eeffffffffffffff)`\\\n`\u00a0=\u00a052b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3b`\\\n`\u00a0`\\\n`\u00a0hashOutputs:`\\\n`\u00a0\u00a0\u00a0dSHA256(202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac)`\\\n`\u00a0=\u00a0863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e5`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage:\u00a00100000096b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd3752b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3bef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a010000001976a9141d0f172a0ecb48aee1be1f2687d2963ae33f71a188ac0046c32300000000ffffffff863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e51100000001000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a096b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd37`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a052b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3b`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a0ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a01000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a01976a9141d0f172a0ecb48aee1be1f2687d2963ae33f71a188ac`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00046c32300000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a0863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e5`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a011000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0c37af31116d1b27caf68aae9e3ac82f1477929014d5b917657d0eb49478cb670`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a0304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee`\\\n`\u00a0\u00a0\u00a0`\\\n`\u00a0The\u00a0serialized\u00a0signed\u00a0transaction\u00a0is:\u00a001000000000102fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f00000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01eeffffffef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a0100000000ffffffff02202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac000247304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee0121025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee635711000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0marker:\u00a0\u00a0\u00a0\u00a000`\\\n`\u00a0\u00a0\u00a0flag:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f\u00a000000000\u00a0494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01\u00a0eeffffff`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a\u00a001000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0202cb20600000000\u00a01976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a09093510d00000000\u00a01976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac`\\\n`\u00a0\u00a0\u00a0witness\u00a0\u00a0\u00a0\u00a000`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a047304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee01\u00a021025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee6357`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a011000000`"
    },
    {
      "header": "P2SH-P2WPKH {#p2sh_p2wpkh}",
      "content": "`\u00a0The\u00a0following\u00a0is\u00a0an\u00a0unsigned\u00a0transaction:\u00a00100000001db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a54770100000000feffffff02b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac92040000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001\u00a0db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477\u00a001000000\u00a000\u00a0feffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0b8b4eb0b00000000\u00a01976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00008af2f00000000\u00a01976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a092040000`\\\n`\u00a0`\\\n`\u00a0The\u00a0input\u00a0comes\u00a0from\u00a0a\u00a0P2SH-P2WPKH\u00a0witness\u00a0program:`\\\n`\u00a0\u00a0\u00a0scriptPubKey\u00a0:\u00a0a9144733f37cf4db86fbc2efed2500b4f4e49f31202387,\u00a0value:\u00a010`\\\n`\u00a0\u00a0\u00a0redeemScript\u00a0:\u00a0001479091972186c449eb1ded22b78e40d009bdf0089`\\\n`\u00a0\u00a0\u00a0private\u00a0key\u00a0\u00a0:\u00a0eb696a065ef48a2192da5b28b694f87544b30fae8327c4510137a922f32c6dcf`\\\n`\u00a0\u00a0\u00a0public\u00a0key\u00a0\u00a0\u00a0:\u00a003ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a26873`\\\n`\u00a0`\\\n`\u00a0To\u00a0sign\u00a0it\u00a0with\u00a0a\u00a0nHashType\u00a0of\u00a01\u00a0(SIGHASH_ALL):`\\\n`\u00a0`\\\n`\u00a0hashPrevouts:`\\\n`\u00a0\u00a0\u00a0dSHA256(db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a547701000000)`\\\n`\u00a0=\u00a0b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a`\\\n`\u00a0`\\\n`\u00a0hashSequence:`\\\n`\u00a0\u00a0\u00a0dSHA256(feffffff)`\\\n`\u00a0=\u00a018606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198`\\\n`\u00a0`\\\n`\u00a0hashOutputs:`\\\n`\u00a0\u00a0\u00a0dSHA256(b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac)`\\\n`\u00a0=\u00a0de984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c83`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage:\u00a001000000b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a18606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477010000001976a91479091972186c449eb1ded22b78e40d009bdf008988ac00ca9a3b00000000feffffffde984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c839204000001000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a0b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a018606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a0db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a547701000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a01976a91479091972186c449eb1ded22b78e40d009bdf008988ac`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a000ca9a3b00000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0feffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a0de984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c83`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a092040000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a064f3b0f4dd2bb3aa1ce8566d220cc74dda9df97d8490cc81d89d735c92e59fb6`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a03044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb01`\\\n`\u00a0`\\\n`\u00a0The\u00a0serialized\u00a0signed\u00a0transaction\u00a0is:\u00a001000000000101db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477010000001716001479091972186c449eb1ded22b78e40d009bdf0089feffffff02b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac02473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb012103ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a2687392040000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0marker:\u00a0\u00a0\u00a0\u00a000`\\\n`\u00a0\u00a0\u00a0flag:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001\u00a0db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477\u00a001000000\u00a01716001479091972186c449eb1ded22b78e40d009bdf0089\u00a0feffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0b8b4eb0b00000000\u00a01976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00008af2f00000000\u00a01976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac`\\\n`\u00a0\u00a0\u00a0witness\u00a0\u00a0\u00a0\u00a002\u00a0473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb01\u00a02103ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a26873`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a092040000`"
    },
    {
      "header": "Native P2WSH {#native_p2wsh}",
      "content": "This example shows how `OP_CODESEPARATOR` and out-of-range\n`SIGHASH_SINGLE` are processed:\n\n`\u00a0The\u00a0following\u00a0is\u00a0an\u00a0unsigned\u00a0transaction:`\\\n`\u00a0\u00a0\u00a00100000002fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e0000000000ffffffff0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000000ffffffff0100f2052a010000001976a914a30741f8145e5acadf23f751864167f32e0963f788ac00000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f8\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a001\u00a000f2052a01000000\u00a01976a914a30741f8145e5acadf23f751864167f32e0963f788ac`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a000000000`\\\n`\u00a0`\\\n`\u00a0The\u00a0first\u00a0input\u00a0comes\u00a0from\u00a0an\u00a0ordinary\u00a0P2PK:`\\\n`\u00a0\u00a0\u00a0scriptPubKey:\u00a021036d5c20fa14fb2f635474c1dc4ef5909d4568e5569b79fc94d3448486e14685f8ac\u00a0value:\u00a01.5625`\\\n`\u00a0\u00a0\u00a0private\u00a0key:\u00a0\u00a0b8f28a772fccbf9b4f58a4f027e07dc2e35e7cd80529975e292ea34f84c4580c`\\\n`\u00a0\u00a0\u00a0signature:\u00a0\u00a0\u00a0\u00a0304402200af4e47c9b9629dbecc21f73af989bdaa911f7e6f6c2e9394588a3aa68f81e9902204f3fcf6ade7e5abb1295b6774c8e0abd94ae62217367096bc02ee5e435b67da201\u00a0(SIGHASH_ALL)`\\\n`\u00a0`\\\n`\u00a0The\u00a0second\u00a0input\u00a0comes\u00a0from\u00a0a\u00a0native\u00a0P2WSH\u00a0witness\u00a0program:`\\\n`\u00a0\u00a0\u00a0scriptPubKey\u00a0:\u00a000205d1b56b63d714eebe542309525f484b7e9d6f686b3781b6f61ef925d66d6f6a0,\u00a0value:\u00a049`\\\n`\u00a0\u00a0\u00a0witnessScript:\u00a021026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880ae>\u00a0CHECKSIGVERIFY\u00a0CODESEPARATOR\u00a0<0255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465>\u00a0CHECKSIG`\\\n`\u00a0`\\\n`\u00a0To\u00a0sign\u00a0it\u00a0with\u00a0a\u00a0nHashType\u00a0of\u00a03\u00a0(SIGHASH_SINGLE):`\\\n`\u00a0`\\\n`\u00a0hashPrevouts:`\\\n`\u00a0\u00a0\u00a0dSHA256(fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f800000000)`\\\n`\u00a0=\u00a0ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d41`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a0ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d41`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a00815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f800000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0(see\u00a0below)`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00011102401000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a00000000000000000000000000000000000000000000000000000000000000000\u00a0(this\u00a0is\u00a0the\u00a0second\u00a0input\u00a0but\u00a0there\u00a0is\u00a0only\u00a0one\u00a0output)`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a003000000`\\\n`\u00a0`\\\n`\u00a0scriptCode:\u00a0\u00a04721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0^^`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(please\u00a0note\u00a0that\u00a0the\u00a0not-yet-executed\u00a0OP_CODESEPARATOR\u00a0is\u00a0not\u00a0removed\u00a0from\u00a0the\u00a0scriptCode)`\\\n`\u00a0preimage:\u00a0\u00a0\u00a0\u00a001000000ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d4100000000000000000000000000000000000000000000000000000000000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f8000000004721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac0011102401000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000003000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a082dde6e4f1e94d02c2b7ad03d2115d691f48d064e9d52f58194a6637e4194391`\\\n`\u00a0public\u00a0key:\u00a0\u00a0026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880ae`\\\n`\u00a0private\u00a0key:\u00a08e02b539b1500aa7c81cf3fed177448a546f19d2be416c0c61ff28e577d8d0cd`\\\n`\u00a0signature:\u00a0\u00a0\u00a03044022027dc95ad6b740fe5129e7e62a75dd00f291a2aeb1200b84b09d9e3789406b6c002201a9ecd315dd6a0e632ab20bbb98948bc0c6fb204f2c286963bb48517a7058e2703`\\\n`\u00a0`\\\n`\u00a0scriptCode:\u00a0\u00a023210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(everything\u00a0up\u00a0to\u00a0the\u00a0last\u00a0executed\u00a0OP_CODESEPARATOR,\u00a0including\u00a0that\u00a0OP_CODESEPARATOR,\u00a0are\u00a0removed)`\\\n`\u00a0preimage:\u00a0\u00a0\u00a0\u00a001000000ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d4100000000000000000000000000000000000000000000000000000000000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000023210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac0011102401000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000003000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0fef7bd749cce710c5c052bd796df1af0d935e59cea63736268bcbe2d2134fc47`\\\n`\u00a0public\u00a0key:\u00a0\u00a00255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465`\\\n`\u00a0private\u00a0key:\u00a086bf2ed75935a0cbef03b89d72034bb4c189d381037a5ac121a70016db8896ec`\\\n`\u00a0signature:\u00a0\u00a0\u00a0304402200de66acf4527789bfda55fc5459e214fa6083f936b430a762c629656216805ac0220396f550692cd347171cbc1ef1f51e15282e837bb2b30860dc77c8f78bc8501e503`\\\n`\u00a0`\\\n`\u00a0The\u00a0serialized\u00a0signed\u00a0transaction\u00a0is:\u00a001000000000102fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e000000004847304402200af4e47c9b9629dbecc21f73af989bdaa911f7e6f6c2e9394588a3aa68f81e9902204f3fcf6ade7e5abb1295b6774c8e0abd94ae62217367096bc02ee5e435b67da201ffffffff0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000000ffffffff0100f2052a010000001976a914a30741f8145e5acadf23f751864167f32e0963f788ac000347304402200de66acf4527789bfda55fc5459e214fa6083f936b430a762c629656216805ac0220396f550692cd347171cbc1ef1f51e15282e837bb2b30860dc77c8f78bc8501e503473044022027dc95ad6b740fe5129e7e62a75dd00f291a2aeb1200b84b09d9e3789406b6c002201a9ecd315dd6a0e632ab20bbb98948bc0c6fb204f2c286963bb48517a7058e27034721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac00000000`\n\nThis example shows how unexecuted `OP_CODESEPARATOR` is processed, and\n`SINGLE|ANYONECANPAY` does not commit to the input index:\n\n`\u00a0The\u00a0following\u00a0is\u00a0an\u00a0unsigned\u00a0transaction:`\\\n`\u00a0\u00a0\u00a00100000002e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffff0280969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac80969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac00000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a080e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a08096980000000000\u00a01976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a08096980000000000\u00a01976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a000000000`\\\n`\u00a0`\\\n`\u00a0The\u00a0first\u00a0input\u00a0comes\u00a0from\u00a0a\u00a0native\u00a0P2WSH\u00a0witness\u00a0program:`\\\n`\u00a0\u00a0\u00a0scriptPubKey:\u00a00020ba468eea561b26301e4cf69fa34bde4ad60c81e70f059f045ca9a79931004a4d\u00a0value:\u00a00.16777215`\\\n`\u00a0\u00a0\u00a0witnessScript:0063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00\u00a0IF\u00a0CODESEPARATOR\u00a0ENDIF\u00a0<0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98>\u00a0CHECKSIG`\\\n`\u00a0`\\\n`\u00a0The\u00a0second\u00a0input\u00a0comes\u00a0from\u00a0a\u00a0native\u00a0P2WSH\u00a0witness\u00a0program:`\\\n`\u00a0\u00a0\u00a0scriptPubKey:\u00a00020d9bbfbe56af7c4b7f960a70d7ea107156913d9e5a26b0a71429df5e097ca6537\u00a0value:\u00a00.16777215`\\\n`\u00a0\u00a0\u00a0witnessScript:5163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01\u00a0IF\u00a0CODESEPARATOR\u00a0ENDIF\u00a0<0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98>\u00a0CHECKSIG`\\\n`\u00a0`\\\n`\u00a0To\u00a0sign\u00a0it\u00a0with\u00a0a\u00a0nHashType\u00a0of\u00a00x83\u00a0(SINGLE|ANYONECANPAY):`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a0(see\u00a0below)`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0(see\u00a0below)`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ffffff0000000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a0(see\u00a0below)`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a083000000`\\\n`\u00a0`\\\n`\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc00100000000`\\\n`\u00a0scriptCode:\u00a0\u00a0270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(since\u00a0the\u00a0OP_CODESEPARATOR\u00a0is\u00a0not\u00a0executed,\u00a0nothing\u00a0is\u00a0removed\u00a0from\u00a0the\u00a0scriptCode)`\\\n`\u00a0hashOutputs:\u00a0b258eaf08c39fbe9fbac97c15c7e7adeb8df142b0df6f83e017f349c2b6fe3d2`\\\n`\u00a0preimage:\u00a0\u00a0\u00a0\u00a00100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc00100000000270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98acffffff0000000000ffffffffb258eaf08c39fbe9fbac97c15c7e7adeb8df142b0df6f83e017f349c2b6fe3d20000000083000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0e9071e75e25b8a1e298a72f0d2e9f4f95a0f5cdf86a533cda597eb402ed13b3a`\\\n`\u00a0public\u00a0key:\u00a0\u00a00392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98`\\\n`\u00a0private\u00a0key:\u00a0f52b3484edd96598e02a9c89c4492e9c1e2031f471c49fd721fe68b3ce37780d`\\\n`\u00a0signature:\u00a0\u00a0\u00a03045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683`\\\n`\u00a0`\\\n`\u00a0outpoint:\u00a0\u00a0\u00a0\u00a080e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b00000000`\\\n`\u00a0scriptCode:\u00a0\u00a02468210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0(everything\u00a0up\u00a0to\u00a0the\u00a0last\u00a0executed\u00a0OP_CODESEPARATOR,\u00a0including\u00a0that\u00a0OP_CODESEPARATOR,\u00a0are\u00a0removed)`\\\n`\u00a0hashOutputs:\u00a091ea93dd77f702b738ebdbf3048940a98310e869a7bb8fa2c6cb3312916947ca`\\\n`\u00a0preimage:\u00a0\u00a0\u00a0\u00a0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b000000002468210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98acffffff0000000000ffffffff91ea93dd77f702b738ebdbf3048940a98310e869a7bb8fa2c6cb3312916947ca0000000083000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0cd72f1f1a433ee9df816857fad88d8ebd97e09a75cd481583eb841c330275e54`\\\n`\u00a0public\u00a0key:\u00a0\u00a00392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98`\\\n`\u00a0private\u00a0key:\u00a0f52b3484edd96598e02a9c89c4492e9c1e2031f471c49fd721fe68b3ce37780d`\\\n`\u00a0signature:\u00a0\u00a0\u00a030440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83`\\\n`\u00a0`\\\n`\u00a0The\u00a0serialized\u00a0signed\u00a0transaction\u00a0is:`\\\n`\u00a001000000000102e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffff0280969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac80969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac02483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac024730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac00000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0marker:\u00a0\u00a0\u00a0\u00a000`\\\n`\u00a0\u00a0\u00a0flag:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a080e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a08096980000000000\u00a01976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a08096980000000000\u00a01976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac`\\\n`\u00a0\u00a0\u00a0witness\u00a0\u00a0\u00a0\u00a002\u00a0483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683\u00a0270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a04730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83\u00a0275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a000000000`\\\n`\u00a0`\\\n`\u00a0Since\u00a0SINGLE|ANYONECANPAY\u00a0does\u00a0not\u00a0commit\u00a0to\u00a0the\u00a0input\u00a0index,\u00a0the\u00a0signatures\u00a0are\u00a0still\u00a0valid\u00a0when\u00a0the\u00a0input-output\u00a0pairs\u00a0are\u00a0swapped:`\\\n`\u00a00100000000010280e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffffe9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff0280969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac80969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac024730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac02483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac00000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0marker:\u00a0\u00a0\u00a0\u00a000`\\\n`\u00a0\u00a0\u00a0flag:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a080e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001\u00a000000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a08096980000000000\u00a01976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a08096980000000000\u00a01976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac`\\\n`\u00a0\u00a0\u00a0witness\u00a0\u00a0\u00a0\u00a002\u00a04730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83\u00a0275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002\u00a0483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683\u00a0270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a000000000`"
    },
    {
      "header": "P2SH-P2WSH {#p2sh_p2wsh}",
      "content": "This example is a P2SH-P2WSH 6-of-6 multisig witness program signed with\n6 different `SIGHASH` types.\n\n`\u00a0The\u00a0following\u00a0is\u00a0an\u00a0unsigned\u00a0transaction:\u00a0010000000136641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e0100000000ffffffff0200e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac00000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001\u00a036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e\u00a001000000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a002\u00a000e9a43500000000\u00a01976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0c0832f0500000000\u00a01976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a000000000`\\\n`\u00a0`\\\n`\u00a0The\u00a0input\u00a0comes\u00a0from\u00a0a\u00a0P2SH-P2WSH\u00a06-of-6\u00a0multisig\u00a0witness\u00a0program:`\\\n`\u00a0\u00a0\u00a0scriptPubKey\u00a0:\u00a0a9149993a429037b5d912407a71c252019287b8d27a587,\u00a0value:\u00a09.87654321`\\\n`\u00a0\u00a0\u00a0redeemScript\u00a0:\u00a00020a16b5755f7f6f96dbd65f5f0d6ab9418b89af4b1f14a1bb8a09062c35f0dcb54`\\\n`\u00a0\u00a0\u00a0witnessScript:\u00a056210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae`\\\n`\u00a0`\\\n`\u00a0hashPrevouts:`\\\n`\u00a0\u00a0\u00a0dSHA256(36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000)`\\\n`\u00a0=\u00a074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0`\\\n`\u00a0`\\\n`\u00a0hashSequence:`\\\n`\u00a0\u00a0\u00a0dSHA256(ffffffff)`\\\n`\u00a0=\u00a03bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044`\\\n`\u00a0`\\\n`\u00a0hashOutputs\u00a0for\u00a0ALL:`\\\n`\u00a0\u00a0\u00a0dSHA256(00e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac)`\\\n`\u00a0=\u00a0bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc`\\\n`\u00a0`\\\n`\u00a0hashOutputs\u00a0for\u00a0SINGLE:`\\\n`\u00a0\u00a0\u00a0dSHA256(00e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac)`\\\n`\u00a0=\u00a09efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage\u00a0for\u00a0ALL:\u00a00100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa03bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e7066504436641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffffbc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc0000000001000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a03bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0b168de3a00000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a0bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0185c0be5263dce5b4bb50a047973c1b6272bfbd0103a89444597dc40b248ee7c`\\\n`\u00a0public\u00a0key:\u00a0\u00a0\u00a00307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba3`\\\n`\u00a0private\u00a0key:\u00a0\u00a0730fff80e1413068a05b57d6a58261f07551163369787f349438ea38ca80fac6`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a0304402206ac44d672dac41f9b00e28f4df20c52eeb087207e8d758d76d92c6fab3b73e2b0220367750dbbe19290069cba53d096f44530e4f98acaa594810388cf7409a1870ce01`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage\u00a0for\u00a0NONE:\u00a00100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000002000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0b168de3a00000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a002000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0e9733bc60ea13c95c6527066bb975a2ff29a925e80aa14c213f686cbae5d2f36`\\\n`\u00a0public\u00a0key:\u00a0\u00a0\u00a0\u00a0\u00a003b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b`\\\n`\u00a0private\u00a0key:\u00a0\u00a0\u00a0\u00a011fa3d25a17cbc22b29c44a484ba552b5a53149d106d3d853e22fdd05a2d8bb3`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03044022068c7946a43232757cbdf9176f009a928e1cd9a1a8c212f15c1e11ac9f2925d9002205b75f937ff2f9f3c1246e547e54f62e027f64eefa2695578cc6432cdabce271502`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage\u00a0for\u00a0SINGLE:\u00a00100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f7080000000003000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0b168de3a00000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a09efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a003000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a01e1f1c303dc025bd664acb72e583e933fae4cff9148bf78c157d1e8f78530aea`\\\n`\u00a0public\u00a0key:\u00a0\u00a0\u00a0\u00a0\u00a0034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a`\\\n`\u00a0private\u00a0key:\u00a0\u00a0\u00a0\u00a077bf4141a87d55bdd7f3cd0bdccf6e9e642935fec45f2f30047be7b799120661`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03044022059ebf56d98010a932cf8ecfec54c48e6139ed6adb0728c09cbe1e4fa0915302e022007cd986c8fa870ff5d2b3a89139c9fe7e499259875357e20fcbb15571c76795403`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage\u00a0for\u00a0ALL|ANYONECANPAY:\u00a0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffffbc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc0000000081000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0b168de3a00000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a0bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a081000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02a67f03e63a6a422125878b40b82da593be8d4efaafe88ee528af6e5a9955c6e`\\\n`\u00a0public\u00a0key:\u00a0\u00a0\u00a0\u00a0\u00a0033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f4`\\\n`\u00a0private\u00a0key:\u00a0\u00a0\u00a0\u00a014af36970f5025ea3e8b5542c0f8ebe7763e674838d08808896b63c3351ffe49`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03045022100fbefd94bd0a488d50b79102b5dad4ab6ced30c4069f1eaa69a4b5a763414067e02203156c6a5c9cf88f91265f5a942e96213afae16d83321c8b31bb342142a14d16381`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage\u00a0for\u00a0NONE|ANYONECANPAY:\u00a0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000082000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0b168de3a00000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a082000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0781ba15f3779d5542ce8ecb5c18716733a5ee42a6f51488ec96154934e2c890a`\\\n`\u00a0public\u00a0key:\u00a0\u00a0\u00a0\u00a0\u00a003a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac16`\\\n`\u00a0private\u00a0key:\u00a0\u00a0\u00a0\u00a0fe9a95c19eef81dde2b95c1284ef39be497d128e2aa46916fb02d552485e0323`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03045022100a5263ea0553ba89221984bd7f0b13613db16e7a70c549a86de0cc0444141a407022005c360ef0ae5a5d4f9f2f87a56c1546cc8268cab08c73501d6b3be2e1e1a8a0882`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage\u00a0for\u00a0SINGLE|ANYONECANPAY:\u00a0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f7080000000083000000`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a00000000000000000000000000000000000000000000000000000000000000000`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a0cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0b168de3a00000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a09efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a083000000`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0511e8e52ed574121fc1b654970395502128263f62662e076dc6baf05c2e6a99b`\\\n`\u00a0public\u00a0key:\u00a0\u00a0\u00a0\u00a0\u00a002d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b`\\\n`\u00a0private\u00a0key:\u00a0\u00a0\u00a0\u00a0428a7aee9f0c2af0cd19af3cf1c78149951ea528726989b2e83e4778d2c3f890`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a030440220525406a1482936d5a21888260dc165497a90a15669636d8edca6b9fe490d309c022032af0c646a34a44d1f4576bf6a4a74b67940f8faa84c7df9abe12a01a11e2b4783`\\\n`\u00a0`\\\n`\u00a0The\u00a0serialized\u00a0signed\u00a0transaction\u00a0is:\u00a00100000000010136641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e0100000023220020a16b5755f7f6f96dbd65f5f0d6ab9418b89af4b1f14a1bb8a09062c35f0dcb54ffffffff0200e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac080047304402206ac44d672dac41f9b00e28f4df20c52eeb087207e8d758d76d92c6fab3b73e2b0220367750dbbe19290069cba53d096f44530e4f98acaa594810388cf7409a1870ce01473044022068c7946a43232757cbdf9176f009a928e1cd9a1a8c212f15c1e11ac9f2925d9002205b75f937ff2f9f3c1246e547e54f62e027f64eefa2695578cc6432cdabce271502473044022059ebf56d98010a932cf8ecfec54c48e6139ed6adb0728c09cbe1e4fa0915302e022007cd986c8fa870ff5d2b3a89139c9fe7e499259875357e20fcbb15571c76795403483045022100fbefd94bd0a488d50b79102b5dad4ab6ced30c4069f1eaa69a4b5a763414067e02203156c6a5c9cf88f91265f5a942e96213afae16d83321c8b31bb342142a14d16381483045022100a5263ea0553ba89221984bd7f0b13613db16e7a70c549a86de0cc0444141a407022005c360ef0ae5a5d4f9f2f87a56c1546cc8268cab08c73501d6b3be2e1e1a8a08824730440220525406a1482936d5a21888260dc165497a90a15669636d8edca6b9fe490d309c022032af0c646a34a44d1f4576bf6a4a74b67940f8faa84c7df9abe12a01a11e2b4783cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae00000000`"
    },
    {
      "header": "No FindAndDelete {#no_findanddelete}",
      "content": "These examples show that `FindAndDelete` for the signature is not\napplied. The transactions are generated in an unconventional way.\nInstead of signing using a private key, the signatures are\npre-determined as part of `witnessScript`. The public keys are generated\nwith key recovery, using the fixed signatures and the `sighash` defined\nin this proposal. Therefore, the private keys are unknown.\n\n`\u00a0The\u00a0following\u00a0is\u00a0an\u00a0unsigned\u00a0transaction:\u00a0010000000169c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d000000ffffffff0101000000000000000000000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001\u00a069c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f1\u00a04c1d0000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a001\u00a00100000000000000\u00a000`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a000000000`\\\n`\u00a0`\\\n`\u00a0The\u00a0input\u00a0comes\u00a0from\u00a0a\u00a0P2WSH\u00a0witness\u00a0program:`\\\n`\u00a0\u00a0\u00a0scriptPubKey\u00a0:\u00a000209e1be07558ea5cc8e02ed1d80c0911048afad949affa36d5c3951e3159dbea19,\u00a0value:\u00a0200000`\\\n`\u00a0\u00a0\u00a0redeemScript\u00a0:\u00a0OP_CHECKSIGVERIFY\u00a0<0x30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01>`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01`\\\n`\u00a0`\\\n`\u00a0To\u00a0sign\u00a0it\u00a0with\u00a0a\u00a0nHashType\u00a0of\u00a01\u00a0(SIGHASH_ALL):`\\\n`\u00a0`\\\n`\u00a0hashPrevouts:`\\\n`\u00a0\u00a0\u00a0dSHA256(69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d0000)`\\\n`\u00a0=\u00a0b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f`\\\n`\u00a0`\\\n`\u00a0hashSequence:`\\\n`\u00a0\u00a0\u00a0dSHA256(ffffffff)`\\\n`\u00a0=\u00a03bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044`\\\n`\u00a0`\\\n`\u00a0hashOutputs:`\\\n`\u00a0\u00a0\u00a0dSHA256(010000000000000000)`\\\n`\u00a0=\u00a0e5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b934228`\\\n`\u00a0`\\\n`\u00a0hash\u00a0preimage:\u00a001000000b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e7066504469c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d00004aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01400d030000000000ffffffffe5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b9342280000000001000000`\\\n`\u00a0`\\\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0hashPrevouts:\u00a0b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f`\\\n`\u00a0\u00a0\u00a0hashSequence:\u00a03bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044`\\\n`\u00a0\u00a0\u00a0outpoint:\u00a0\u00a0\u00a0\u00a0\u00a069c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d0000`\\\n`\u00a0\u00a0\u00a0scriptCode:\u00a0\u00a0\u00a04aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01`\\\n`\u00a0\u00a0\u00a0amount:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0400d030000000000`\\\n`\u00a0\u00a0\u00a0nSequence:\u00a0\u00a0\u00a0\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0hashOutputs:\u00a0\u00a0e5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b934228`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a0\u00a0\u00a0\u00a000000000`\\\n`\u00a0\u00a0\u00a0nHashType:\u00a0\u00a0\u00a0\u00a001000000`\\\n`\u00a0`\\\n`\u00a0sigHash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a071c9cd9b2869b9c70b01b1f0360c148f42dee72297db312638df136f43311f23`\\\n`\u00a0signature:\u00a0\u00a0\u00a0\u00a030450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e\u00a001`\\\n`\u00a0pubkey:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a002a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c`\\\n`\u00a0`\\\n`\u00a0The\u00a0serialized\u00a0signed\u00a0transaction\u00a0is:\u00a00100000000010169c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d000000ffffffff01010000000000000000034830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e012102a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c4aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0100000000`\n\n`\u00a0\u00a0\u00a0nVersion:\u00a0\u00a001000000`\\\n`\u00a0\u00a0\u00a0marker:\u00a0\u00a0\u00a0\u00a000`\\\n`\u00a0\u00a0\u00a0flag:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001`\\\n`\u00a0\u00a0\u00a0txin:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a001\u00a069c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f1\u00a04c1d0000\u00a000\u00a0ffffffff`\\\n`\u00a0\u00a0\u00a0txout:\u00a0\u00a0\u00a0\u00a0\u00a001\u00a00100000000000000\u00a000`\\\n`\u00a0\u00a0\u00a0witness:\u00a0\u00a0\u00a003\u00a04830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02102a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01`\\\n`\u00a0\u00a0\u00a0nLockTime:\u00a000000000`\\\n`\u00a0`\n\n`\u00a0The\u00a0following\u00a0transaction\u00a0is\u00a0a\u00a0``OP_CHECKMULTISIGVERIFY``\u00a0version\u00a0of\u00a0the\u00a0``FindAndDelete``\u00a0examples:\u00a0010000000001019275cb8d4a485ce95741c013f7c0d28722160008021bb469a11982d47a6628964c1d000000ffffffff0101000000000000000007004830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960101022102966f109c54e85d3aee8321301136cedeb9fc710fdef58a9de8a73942f8e567c021034ffc99dd9a79dd3cb31e2ab3e0b09e0e67db41ac068c625cd1f491576016c84e9552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c039596017500000000`\\\n`\u00a0`\\\n`\u00a0redeemScript:\u00a0\u00a0OP_2\u00a0OP_CHECKMULTISIGVERIFY\u00a0<30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01>\u00a0<304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c03959601>`\\\n`\u00a0hash\u00a0preimage:\u00a00100000039283953eb1e26994dde57b7f9362a79a8c523e2f8deba943c27e826a005f1e63bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e706650449275cb8d4a485ce95741c013f7c0d28722160008021bb469a11982d47a6628964c1d00009552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960175400d030000000000ffffffffe5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b9342280000000001000000`\\\n`\u00a0sighash:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0c1628a1e7c67f14ca0c27c06e4fdeec2e6d1a73c7a91d7c046ff83e835aebb72`\\\n`\u00a0witness:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a007\u00a000`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a04830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a048304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c03959601`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a00102`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a02102966f109c54e85d3aee8321301136cedeb9fc710fdef58a9de8a73942f8e567c0`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a021034ffc99dd9a79dd3cb31e2ab3e0b09e0e67db41ac068c625cd1f491576016c84e`\\\n`\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a09552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960175`\n\nThe new serialization format is described in BIP144 [^9]"
    },
    {
      "header": "Deployment",
      "content": "This proposal is deployed with Segregated Witness softfork (BIP 141)"
    },
    {
      "header": "Backward compatibility {#backward_compatibility}",
      "content": "As a soft fork, older software will continue to operate without\nmodification. Non-upgraded nodes, however, will not see nor validate the\nwitness data and will consider all witness programs, including the\nredefined sigops, as anyone-can-spend scripts."
    },
    {
      "header": "Reference Implementation {#reference_implementation}",
      "content": "<https://github.com/bitcoin/bitcoin/pull/8149>"
    },
    {
      "header": "References",
      "content": "```{=html}\n<references />\n```"
    },
    {
      "header": "Copyright",
      "content": "This document is placed in the public domain.\n\n[^1]: [1](https://en.bitcoin.it/wiki/OP_CHECKSIG)\n\n[^2]: [CVE-2013-2292](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-2292)\n\n[^3]: [New Bitcoin vulnerability: A transaction that takes at least 3\nminutes to verify](https://bitcointalk.org/?topic=140078)\n\n[^4]: [The Megatransaction: Why Does It Take 25\nSeconds?](http://rusty.ozlabs.org/?p=522)\n\n[^5]: [SIGHASH_WITHINPUTVALUE: Super-lightweight HW wallets and offline\ndata](https://bitcointalk.org/index.php?topic=181734.0)\n\n[^6]: [BIP141: Segregated Witness (Consensus\nlayer)](https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki)\n\n[^7]:\n\n[^8]: In the original algorithm, a `uint256` of `0x0000......0001` is\ncommitted if the input index for a `SINGLE` signature is greater\nthan or equal to the number of outputs. In this BIP a\n`0x0000......0000` is committed, without changing the semantics.\n\n[^9]: [BIP144: Segregated Witness (Peer\nServices)](bip-0144.mediawiki \"wikilink\")"
    }
  ]
}