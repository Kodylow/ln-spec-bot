{
  "BIP": "129",
  "Layer": "Applications",
  "Title": "Bitcoin Secure Multisig Setup (BSMS)",
  "Author": "Hugo Nguyen <hugo@nunchuk.io>",
  "Comments-Summary": "No comments yet.",
  "Comments-URI": "https://github.com/bitcoin/bips/wiki/Comments:BIP-0129",
  "Status": "Proposed",
  "Type": "Standards Track",
  "Created": "2020-11-10",
  "License": "BSD-2-Clause",
  "sections": [
    {
      "header": "Introduction",
      "content": "### Abstract\n\nThis document proposes a mechanism to set up multisig wallets securely."
    },
    {
      "header": "Copyright",
      "content": "This BIP is licensed under the 2-clause BSD license."
    },
    {
      "header": "Motivation",
      "content": "The Bitcoin multisig experience has been greatly streamlined under\n[BIP-0174 (Partially Signed Bitcoin\nTransaction)](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki).\nHowever, what is still missing is a standardized process for setting up\nmultisig wallets securely across different vendors.\n\nThere are a number of concerns when it comes to setting up a multisig\nwallet:\n\n1.  Whether the multisig configuration, such as Signer membership,\nscript type, derivation paths and number of signatures required, is\ncorrect and not tampered with.\n2.  Whether the keys or the multisig configuration are leaked during the\nsetup.\n3.  Whether the Signer persists the multisig configuration in their\nrespective storage, and under what format.\n4.  Whether the Signer\\'s storage is tamper-proof.\n5.  Whether the Signer subsequently uses the multisig configuration to\ngenerate and verify receive and change addresses.\n\nAn attacker who can modify the multisig configuration can steal or hold\nfunds for ransom by duping the user into sending funds to the wrong\naddress. An attacker who cannot modify the configuration but can learn\nabout the keys and/or the configuration can monitor transactions in the\nwallet, resulting in loss of privacy.\n\nThis proposal seeks to address concerns #1, #2 and #3: to mitigate the\nrisk of tampering during the initial setup phase, and to define an\ninteroperable multisig configuration format.\n\nConcerns #4 and #5 should be handled by Signers and are out of scope of\nthis proposal."
    },
    {
      "header": "Specification",
      "content": "### Prerequisites\n\nThis proposal assumes the parties in the multisig support\n[BIP-0032](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki),\n[BIP-0322](https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki),\n[the descriptor\nlanguage](https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md)\nand [AES encryption](https://tools.ietf.org/html/rfc3686)."
    },
    {
      "header": "File Extensions {#file_extensions}",
      "content": "All descriptor and key records should have a `.bsms` file extension.\nEncrypted data should have a `.dat` extension."
    },
    {
      "header": "Roles",
      "content": "#### Coordinator\n\nThe Coordinator initiates the multisig setup. The Coordinator determines\nwhat type of multisig is used and the exact policy script. If encryption\nis enabled, the Coordinator also distributes a shared secret or shared\nsecrets to the parties involved for secure communication. The\nCoordinator gathers information from the Signers to generate a\ndescriptor record. The Coordinator distributes the descriptor record\nback to the Signers."
    },
    {
      "header": "Signer",
      "content": "The Signer is any software or hardware that controls the private keys\nand can sign using those keys. The Signer is a participating member in\nthe multisig. Its responsibilities include providing its key record \\--\nwhich contains a public key or an Extended Public Key (XPUB) \\-- to the\nCoordinator, verifying that its `KEY` is included in the descriptor\nrecord and persisting the descriptor record in its storage."
    },
    {
      "header": "Setup Process {#setup_process}",
      "content": "#### Round 1 {#round_1}"
    },
    {
      "header": "Coordinator {#coordinator_1}",
      "content": "-   The Coordinator creates a new multisig wallet creation session. The\nCoordinator constructs the multisig script and its policy\nparameters, such as the required number of signatures and the total\nnumber of Signers (`M` and `N`).\n-   The session should expire after some time period determined by the\nCoordinator, e.g., 24 hours. The timeout allows the encryption key\nto have lower entropy.\n-   If encryption is enabled, the Coordinator distributes a secret\n`TOKEN` to each Signer over a secure channel. The Signer can use the\n`TOKEN` to derive an `ENCRYPTION_KEY`. Refer to the\n[#Encryption](#Encryption \"wikilink\") section below for details on\nthe `TOKEN`, the key derivation function and the encryption scheme.\nDepending on the use case, the Coordinator can decide whether to\nshare one common `TOKEN` for all Signers, or to have one per Signer.\n-   If encryption is disabled, the `TOKEN` is set to `0x00`, and all the\nencryption/decryption steps below can be skipped."
    },
    {
      "header": "Signer {#signer_1}",
      "content": "-   The Signer initiates the multisig wallet creation session by setting\nthe `TOKEN`. The Signer derives an `ENCRYPTION_KEY` from the\n`TOKEN`. The Signer can keep the session open until a different\nvalue for the `TOKEN` is set.\n-   The Signer generates a key record by prompting the user for a\nmultisig derivation path and retrieves the `KEY` at that derivation\npath. Alternatively, the Signer can choose a path on behalf of the\nuser. If the Signer chooses the path, it should try to avoid reusing\n`KEY`s for different wallets.\n-   The first line in the record must be the specification version\n(`BSMS 1.0` as of this writing). The second line must be the\nhex-encoded `TOKEN`. The third line must be the `KEY`. The `KEY` is\na public key or an XPUB plus the key origin information, written in\nthe descriptor-defined format, i.e.:\n`[{master key fingerprint}/{derivation path}]{KEY}`. The fourth line\nis a text description of the key, 80 characters maximum. The fifth\nline must be a `SIG`, whereas `SIG` is the signature generated by\nusing the private key associated with the public key or XPUB to sign\nthe first four lines. The signature should follow\n[BIP-0322](https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki),\nlegacy format accepted.\n-   The Signer calculates the Message Authentication Code (`MAC`) for\nthe record. The first 16 bytes of the `MAC` serves as the\nInitialization Vector (`IV`) for the encryption.\n-   The Signer encrypts the key record with the `ENCRYPTION_KEY` and\n`IV`.\n-   The Signer encodes the `MAC` and the ciphertext into hexadecimal\nformat, then concatenates the results: `(MAC || ciphertext)`."
    },
    {
      "header": "Round 2 {#round_2}",
      "content": "##### Coordinator {#coordinator_2}\n\n-   The Coordinator gathers key records from all participating Signers.\nThe Coordinator verifies that there are exactly `N` unique key\nrecords before the wallet setup session expires.\n-   For each key record, the Coordinator extracts the `MAC` from the\ndata, sets `IV` to the first 16 bytes of the `MAC`, then decrypts\nthe ciphertext using the `ENCRYPTION_KEY` and `IV`.\n-   The Coordinator verifies that the included `MAC` is valid given the\nplaintext.\n-   The Coordinator verifies that the key records have compatible\nspecification versions.\n-   The Coordinator verifies that the included `SIG` is valid given the\n`KEY`.\n-   If all key records look good, the Coordinator fills in all necessary\ninformation to generate a descriptor record.\n-   The first line in the descriptor record must be the specification\nversion (`BSMS 1.0` as of this writing). The second line must be a\ndescriptor or a descriptor template. The third line must be a\ncomma-separated list of derivation path restrictions. The paths must\nstart with `/` and use non-hardened derivation. If there are no\ntemplate or restrictions, it must say `No path restrictions`. The\nfourth line must be the wallet\\'s first address. If there are path\nrestrictions, use the first address from the first path restriction.\n-   The Coordinator calculates the `MAC` for the record. The first 16\nbytes of the `MAC` serves as the `IV` for the encryption..\n-   The Coordinator encrypts the descriptor record with the\n`ENCRYPTION_KEY` and `IV`.\n-   The Coordinator encodes the `MAC` and the ciphertext into\nhexadecimal format, then concatenates the results:\n`(MAC || ciphertext)`.\n-   The Coordinator sends the encrypted descriptor record to all\nparticipating Signers."
    },
    {
      "header": "Signer {#signer_2}",
      "content": "-   The Signer imports the descriptor record.\n-   The Signer extracts the `MAC` from the data, sets `IV` to the first\n16 bytes of the `MAC`, then decrypts the ciphertext using the\n`ENCRYPTION_KEY` (derived from the open session) and `IV`.\n-   The Signer verifies that the included `MAC` is valid given the\nplaintext.\n-   The Signer verifies that it can support the included specification\nversion.\n-   The Signer verifies that it can support the descriptor or descriptor\ntemplate.\n-   The Signer checks that its `KEY` is included in the descriptor or\ndescriptor template, using path and fingerprint information\nprovided. The check must perform an exact match on the `KEY`s and\nnot using shortcuts such as matching fingerprints, which is trivial\nto spoof.\n-   The Signer verifies that it is compatible with the derivation path\nrestrictions.\n-   The Signer verifies that the wallet\\'s first address is valid.\n-   For confirmation, the Signer must display to the user the wallet\\'s\nfirst address and policy parameters, including, but not limited to:\nthe derivation path restrictions, `M`, `N`, and the position(s) of\nthe Signer\\'s own `KEY` in the policy script. The total number of\nSigners, `N`, is important to prevent a `KEY` insertion attack. The\nposition is important for scripts where `KEY` order matters. When\napplicable, all positions of the `KEY` must be displayed. The full\ndescriptor or descriptor template must also be available for review\nupon user request.\n-   Parties must check with each other that all Signers have the same\nconfirmation (except for the `KEY` positions).\n-   If all checks pass, the Signer must persist the descriptor record in\nits storage.\n\nThis completes the setup."
    },
    {
      "header": "Encryption",
      "content": "#### The Token {#the_token}\n\nWe define three modes of encryption.\n\n1.  `NO_ENCRYPTION` : the `TOKEN` is set to `0x00`. Encryption is\ndisabled.\n2.  `STANDARD` : the `TOKEN` is a 64-bit nonce.\n3.  `EXTENDED` : the `TOKEN` is a 128-bit nonce.\n\nThe `TOKEN` can be converted to one of these formats:\n\n-   A decimal number (recommended). The number must not exceed the\nmaximum value of the nonce.\n-   A mnemonic phrase using\n[BIP-0039](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki)\nword list. This would be 6 words in `STANDARD` mode. This encoding\nis not recommended in `EXTENDED` mode as it can result in potential\nconfusion between seed mnemonics and `TOKEN` mnemonics.\n-   A QR code.\n-   Other formats.\n\nThe flexibility in the data format allows each Signer to customize the\nUser Experience based on its respective capabilities."
    },
    {
      "header": "Key Derivation {#key_derivation}",
      "content": "The key derivation function is\n[PBKDF2](https://tools.ietf.org/html/rfc2898), with PRF = SHA512.\nSpecifically:\n\n`DKey = PBKDF2(PRF, Password, Salt, c, dkLen)`\n\nWhereas:\n\n-   PRF = SHA512\n-   Password = \\\"No SPOF\\\"\n-   Salt = `TOKEN`\n-   c = 2048\n-   dkLen = 256\n-   DKey = Derived `ENCRYPTION_KEY`"
    },
    {
      "header": "Encryption Scheme {#encryption_scheme}",
      "content": "The encryption scheme is\n[AES-256-CTR](https://tools.ietf.org/html/rfc3686).\n\n`MAC = HMAC-SHA256(HMAC_Key, hex-encoded TOKEN || Data)`\n\n`IV = First 16 bytes of MAC`\n\n`Ciphertext = AES-256-CTR-Encrypt(Plaintext, DKey, IV)`\n\n`Plaintext = AES-256-CTR-Decrypt(Ciphertext, DKey, IV)`\n\nWhereas:\n\n-   DKey = `ENCRYPTION_KEY`\n-   HMAC_Key = SHA256(`ENCRYPTION_KEY`)\n-   Data = the plaintext, e.g. the entire key record in round 1 and the\nentire descriptor record in round 2\n\nThe `MAC` is to be sent along with the key and descriptor record, as\nspecified above. Because it is a `MAC` over the entire plaintext, this\nis essentially an\n[Encrypt-and-MAC](https://en.wikipedia.org/wiki/Authenticated_encryption#Encrypt-and-MAC_(E&M))\nform of authenticated encryption."
    },
    {
      "header": "Descriptor Template {#descriptor_template}",
      "content": "The output descriptor language only supports one-dimensional lists. This\nproposal introduces a descriptor template to represent multi-dimensional\nlists:\n\n`XPUB/**`\n\nWhereas `/**` can be replaced by any number of derivation path\nrestrictions.\n\nA descriptor template must be accompanied by derivation path\nrestrictions. Signers should expand the template into concrete\ndescriptors by replacing `/**` with the restrictions.\n\nFor example, the following template and derivation path restrictions:\n\n-   `wsh(sortedmulti(2,XPUB1/**,XPUB2/**))`\n-   `/0/*,/1/*`\n\nShould translate to two concrete descriptors:\n\n-   `wsh(sortedmulti(2,XPUB1/0/*,XPUB2/0/*))`\n-   `wsh(sortedmulti(2,XPUB1/1/*,XPUB2/1/*))`"
    },
    {
      "header": "QR Codes {#qr_codes}",
      "content": "For signers that use QR codes to transmit data, key and descriptor\nrecords can be converted to QR codes, following [the BCR\nstandard](https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-005-ur.md).\n\nAlso refer to [UR Type Definition for BIP44\nAccounts](https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-015-account.md)\nand [UR Type Definition for Bitcoin Output\nDescriptors](https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-010-output-desc.md)\nfor more details."
    },
    {
      "header": "Compatibility",
      "content": "This specification is not backwards compatible with existing multisig\nimplementations.\n\nBSMS is opt-in, meaning existing multisig implementations can continue\nworking as-is, with the caveat that they are likely to have various\npitfalls. Some of the problems with existing solutions have been\ndescribed in the [#Motivation](#Motivation \"wikilink\") section.\n\nTo comply with this standard, a Signer must be able to persist the\ndescriptor record in its storage.\n\nTo use BSMS for a multisig wallet, the user should wait until all\nparticipating Signers in the multisig have implemented BSMS."
    },
    {
      "header": "Security",
      "content": "This proposal introduces two layers of protection. The first one is a\ntemporary, secret `TOKEN`. The second one is the confirmation of the\nwallet\\'s first address.\n\nThe `TOKEN` is used to encrypt the two rounds of communication between\nthe Signer and the Coordinator. A `MAC` is also generated from the\n`TOKEN` and plaintext to authenticate the data being exchanged. The\n`TOKEN` is only needed during the setup phase, and can be safely\ndiscarded afterwards. It is not recommended to use the same `TOKEN` for\nmultiple wallet creation sessions.\n\nThe wallet\\'s first address, on the other hand, can be used to verify\nthe integrity of the multisig configuration. An attacker who tampers\nwith the multisig configuration must also change the wallet\\'s first\naddress. Parties must check with each other that all Signers confirm to\nthe same address and policy parameters to reduce the chance of\ntampering."
    },
    {
      "header": "Privacy",
      "content": "Encryption helps improve the privacy of the wallet by avoiding sharing\nkeys and descriptors in plaintext.\n\nIf the parties wish to have stronger privacy, it is recommended to use a\nhigher number of bits for the `TOKEN`, and to completely erase knowledge\nof the `TOKEN` after the multisig wallet has been set up."
    },
    {
      "header": "Test Vectors {#test_vectors}",
      "content": "### Mode: `NO_ENCRYPTION` with Public Keys {#mode_no_encryption_with_public_keys}"
    },
    {
      "header": "ROUND 1 {#round_1_1}",
      "content": "-   Coordinator\n-   M-of-N: 1/2\n-   ADDRESS_TYPE: NATIVE_SEGWIT\n-   TOKEN: 0x00\n\n```{=html}\n<!-- -->\n```\n-   Signer 1\n-   MASTER_KEY_FINGERPRINT: 59865f44\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/2\\'):\nL5TXU4SdD9e6QGgBjxeegJKxt4FgATLG1TCnFM8JLyEkFuyHEqNM\n-   Public Key (m/48\\'/0\\'/0\\'/2\\'):\n026d15412460ba0d881c21837bb999233896085a9ed4e5445bd637c10e579768ba\n-   Legacy signature\n-   `signer_1_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\n00\n[59865f44/48'/0'/0'/2']026d15412460ba0d881c21837bb999233896085a9ed4e5445bd637c10e579768ba\nSigner 1 key\nH6DXgqkCb353BDPkzppMFpOcdJZlpur0WRetQhIBqSn6DFzoQWBtm+ibP5wERDRNi0bxxev9B+FIvyQWq0s6im4=\n\n-   Signer 2\n-   MASTER_KEY_FINGERPRINT: b7044ca6\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/2\\'):\nKwT7BZDWjos4JAdfKi8NqF46Kj3rppTwN8KGhPbzmmugiZioFW3r\n-   Public Key (m/48\\'/0\\'/0\\'/2\\'):\n030baf0497ab406ff50cb48b4013abac8a0338758d2fd54cd934927afa57cc2062\n-   Legacy signature\n-   `signer_2_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\n00\n[b7044ca6/48'/0'/0'/2']030baf0497ab406ff50cb48b4013abac8a0338758d2fd54cd934927afa57cc2062\nSigner 2 key\nH08mGNGN+NxX/snt+6eX2Q1HjjfDkOtotglshHi7xdsBdIrTVMCQbgQ5SdACNZ0B2AJcifK11nJj43SvaitSemI="
    },
    {
      "header": "ROUND 2 {#round_2_1}",
      "content": "-   Coordinator\n-   `my_multisig_wallet.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\nwsh(sortedmulti(1,[59865f44/48'/0'/0'/2']026d15412460ba0d881c21837bb999233896085a9ed4e5445bd637c10e579768ba,[b7044ca6/48'/0'/0'/2']030baf0497ab406ff50cb48b4013abac8a0338758d2fd54cd934927afa57cc2062))#rzx9dffd\nNo path restrictions\nbc1quqy523xu3l8che3s8vja8n33qtg0uyugr9l5z092s3wa50p8t7rqy6zumf"
    },
    {
      "header": "Mode: `NO_ENCRYPTION` {#mode_no_encryption}",
      "content": "#### ROUND 1 {#round_1_2}\n\n-   Coordinator\n-   M-of-N: 2/2\n-   ADDRESS_TYPE: NATIVE_SEGWIT\n-   TOKEN: 0x00\n\n```{=html}\n<!-- -->\n```\n-   Signer 1\n-   MASTER_KEY_FINGERPRINT: 1cf0bf7e\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/2\\'):\nL3q1sg7iso1L3QfzB1riC9bQpqMynWyBeuLLSKwCDGkHkahB7MgU\n-   XPUB (m/48\\'/0\\'/0\\'/2\\'):\nxpub6FL8FhxNNUVnG64YurPd16AfGyvFLhh7S2uSsDqR3Qfcm6o9jtcMYwh6DvmcBF9qozxNQmTCVvWtxLpKTnhVLN3Pgnu2D3pAoXYFgVyd8Yz\n-   Legacy signature\n-   `signer_1_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\n00\n[1cf0bf7e/48'/0'/0'/2']xpub6FL8FhxNNUVnG64YurPd16AfGyvFLhh7S2uSsDqR3Qfcm6o9jtcMYwh6DvmcBF9qozxNQmTCVvWtxLpKTnhVLN3Pgnu2D3pAoXYFgVyd8Yz\nSigner 1 key\nIB7v+qi1b+Xrwm/3bF+Rjl8QbIJ/FMQ40kUsOOQo1SqUWn5QlFWbBD8BKPRetfo1L1N7DmYjVscZNsmMrqRJGWw=\n\n-   Signer 2\n-   MASTER_KEY_FINGERPRINT: 4fc1dd4a\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/2\\'):\nL4JNkJfLBDyWfTLbKJ1H3w56GUMsvdfjCkzRo5RHXfJ6bdHqm6cN\n-   XPUB (m/48\\'/0\\'/0\\'/2\\'):\nxpub6EebMbEps7ZcV3FYEnddRsvrFWDrt2tiPmCeM7pPXQEmphvq9ZfJ1LWFUDjf3vxCeBuPrfyGrMazWUsYsetrnHatQZVLJH7LsgCjtMqdzgj\n-   Legacy signature\n-   `signer_2_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\n00\n[4fc1dd4a/48'/0'/0'/2']xpub6EebMbEps7ZcV3FYEnddRsvrFWDrt2tiPmCeM7pPXQEmphvq9ZfJ1LWFUDjf3vxCeBuPrfyGrMazWUsYsetrnHatQZVLJH7LsgCjtMqdzgj\nSigner 2 key\nHzUa4Z76PFHMl54flIIF3XKiHZ+KbWjjxCEG5G3ZqZSqTd6OgTiFFLqq9PXJXdfYm6/cnL8IVWQgjFF9DQhIqQs="
    },
    {
      "header": "ROUND 2 {#round_2_2}",
      "content": "-   Coordinator\n-   `my_multisig_wallet.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\nwsh(sortedmulti(2,[1cf0bf7e/48'/0'/0'/2']xpub6FL8FhxNNUVnG64YurPd16AfGyvFLhh7S2uSsDqR3Qfcm6o9jtcMYwh6DvmcBF9qozxNQmTCVvWtxLpKTnhVLN3Pgnu2D3pAoXYFgVyd8Yz/**,[4fc1dd4a/48'/0'/0'/2']xpub6EebMbEps7ZcV3FYEnddRsvrFWDrt2tiPmCeM7pPXQEmphvq9ZfJ1LWFUDjf3vxCeBuPrfyGrMazWUsYsetrnHatQZVLJH7LsgCjtMqdzgj/**))\n/0/*,/1/*\nbc1qrgc6p3kylfztu06ysl752gwwuekhvtfh9vr7zg43jvu60mutamcsv948ej"
    },
    {
      "header": "Mode: `STANDARD` Encryption {#mode_standard_encryption}",
      "content": "#### ROUND 1 {#round_1_3}\n\n-   Coordinator\n-   M-of-N: 2/2\n-   ADDRESS_TYPE: NATIVE_SEGWIT\n-   TOKEN (hex): a54044308ceac9b7\n-   TOKEN (decimal): 11907592390080907703\n-   TOKEN (mnemonic): pipe acquire around border prosper swift\n-   ENCRYPTION_KEY (hex):\n7673ffd9efd70336a5442eda0b31457f7b6cdf7b42fe17f274434df55efa9839\n\n```{=html}\n<!-- -->\n```\n-   Signer 1\n-   MASTER_KEY_FINGERPRINT: b7868815\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/2\\'):\nKyKvR9kf8r7ZVtdn3kB9ifipr6UKnTNTpWJkGZbHwARDCz5iZ39E\n-   XPUB (m/48\\'/0\\'/0\\'/2\\'):\nxpub6FA5rfxJc94K1kNtxRby1hoHwi7YDyTWwx1KUR3FwskaF6HzCbZMz3zQwGnCqdiFeMTPV3YneTGS2YQPiuNYsSvtggWWMQpEJD4jXU7ZzEh\n-   Legacy signature\n-   `signer_1_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\na54044308ceac9b7\n[b7868815/48'/0'/0'/2']xpub6FA5rfxJc94K1kNtxRby1hoHwi7YDyTWwx1KUR3FwskaF6HzCbZMz3zQwGnCqdiFeMTPV3YneTGS2YQPiuNYsSvtggWWMQpEJD4jXU7ZzEh\nSigner 1 key\nH8DYht5P6ko0bQqDV6MtUxpzBSK+aVHxbvMavA5byvLrOlCEGmO1WFR7k2wu42J6dxXD8vrmDQSnGq5MTMMbZ98=\n\n-   Signer 1 encryption\n-   HMAC_KEY (hex):\n3d4c422806ba8964c9ee45070cd675c024d96648a0ddb4001325818c84951de2\n-   MAC (hex):\nfbdbdb64e6a8231c342131d9f13dcd5a954b4c5021658fa5afcb3fc74dc82706\n-   IV (hex) : fbdbdb64e6a8231c342131d9f13dcd5a\n-   CIPHERTEXT (hex):\n53f491cfd1431c292d922ea5a5dec3eb8ddaa6ed38ae109e7b040f0f23013e89a89b4d27476761a01197a3277850b2bc1621ae626efe65f2081eec6eb571c4f787bf1c49d061b43f70fd73cb3f37fa591d2400973ac0644c8941a83f1d4155e98f01fa2fdeb9f86c2e2413154fd18566a28fb0d9d8bd6172efabcfa6dab09ee7029bf3dd43376df52c118a6d291ec168f4ec7f7df951dfc6135fd8cb4b234da62eaea6017dfe5ca418f083e02e3aba2962ba313ba17b6468c7672fb218329a9f3fe4e4887fb87dac57c63ebff0e715a44498d18de8afc10e1cfeb46a1fc65ce871fef8a43b289305433a90c342d025aa4c19454fcfbcf911e9e2f928d5affd0536a6ddc2e816\n-   `signer_1_key.dat`:\nfbdbdb64e6a8231c342131d9f13dcd5a954b4c5021658fa5afcb3fc74dc8270653f491cfd1431c292d922ea5a5dec3eb8ddaa6ed38ae109e7b040f0f23013e89a89b4d27476761a01197a3277850b2bc1621ae626efe65f2081eec6eb571c4f787bf1c49d061b43f70fd73cb3f37fa591d2400973ac0644c8941a83f1d4155e98f01fa2fdeb9f86c2e2413154fd18566a28fb0d9d8bd6172efabcfa6dab09ee7029bf3dd43376df52c118a6d291ec168f4ec7f7df951dfc6135fd8cb4b234da62eaea6017dfe5ca418f083e02e3aba2962ba313ba17b6468c7672fb218329a9f3fe4e4887fb87dac57c63ebff0e715a44498d18de8afc10e1cfeb46a1fc65ce871fef8a43b289305433a90c342d025aa4c19454fcfbcf911e9e2f928d5affd0536a6ddc2e816\n\n```{=html}\n<!-- -->\n```\n-   Signer 2\n-   MASTER_KEY_FINGERPRINT: eedff89a\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/2\\'):\nKz1ijnkDXmc65NWTYdg47DDaQgSGJAPfhJG9Unm36oqZPpPXuNR6\n-   XPUB (m/48\\'/0\\'/0\\'/2\\'):\nxpub6EhJvMneoLWAf8cuyLBLQiKiwh89RAmqXEqYeFuaCEHdHwxSRfzLrUxKXEBap7nZSHAYP7Jfq6gZmucotNzpMQ9Sb1nTqerqW8hrtmx6Y6o\n-   Legacy signature\n-   `signer_2_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\na54044308ceac9b7\n[eedff89a/48'/0'/0'/2']xpub6EhJvMneoLWAf8cuyLBLQiKiwh89RAmqXEqYeFuaCEHdHwxSRfzLrUxKXEBap7nZSHAYP7Jfq6gZmucotNzpMQ9Sb1nTqerqW8hrtmx6Y6o\nSigner 2 key\nH/IHW5dMGYsrRdYEz3ux+kKnkWBtxHzfYkREpnYbco38VnMvIxCbDuf7iu6960qDhBLR/RLjlb9UPtLmCMbczDE=\n\n-   Signer 2 encryption\n-   HMAC_KEY (hex):\n3d4c422806ba8964c9ee45070cd675c024d96648a0ddb4001325818c84951de2\n-   MAC (hex):\n383d05b7351a2cef7cca2850450f5efbbc4a3f8ea35707dda87a3692f0f2ebae\n-   IV (hex) : 383d05b7351a2cef7cca2850450f5efb\n-   CIPHERTEXT (hex):\n71860b7c69f3a7665c3c3e85c45735bff78535a37ec6610b724627c73696820d519a9251703b17626b63898580233bebbb310aedbc370224b044ee19600bfe583445a6f26fb9bb5790bae516892655adb0e5dfc12be4609c2e0818d4f1f3bfccc4cd1a36f419d6cd842c913ae81eef4865ad473c32c3ee69cd98d6d0a088e2abdd01fe68b5c0503bb9183f9a912506204e5a9c6bd5a1626ff7eac30312a0b85004307c525e52fa3ad45a0b02eabc8cfaea0215bb6e60ee5f32d6673955290e008fbaef362977a21fd9830e3a604f9bb318cdcde456eae91dbedaa069bcd1efb0f981d5b0e502bd4dada903205458a00914887226a8dde317c02a8be4342acb97a8fee79fbe23\n-   `signer_2_key.dat`:\n383d05b7351a2cef7cca2850450f5efbbc4a3f8ea35707dda87a3692f0f2ebae71860b7c69f3a7665c3c3e85c45735bff78535a37ec6610b724627c73696820d519a9251703b17626b63898580233bebbb310aedbc370224b044ee19600bfe583445a6f26fb9bb5790bae516892655adb0e5dfc12be4609c2e0818d4f1f3bfccc4cd1a36f419d6cd842c913ae81eef4865ad473c32c3ee69cd98d6d0a088e2abdd01fe68b5c0503bb9183f9a912506204e5a9c6bd5a1626ff7eac30312a0b85004307c525e52fa3ad45a0b02eabc8cfaea0215bb6e60ee5f32d6673955290e008fbaef362977a21fd9830e3a604f9bb318cdcde456eae91dbedaa069bcd1efb0f981d5b0e502bd4dada903205458a00914887226a8dde317c02a8be4342acb97a8fee79fbe23"
    },
    {
      "header": "ROUND 2 {#round_2_3}",
      "content": "-   Coordinator\n-   `my_multisig_wallet.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\nwsh(sortedmulti(2,[b7868815/48'/0'/0'/2']xpub6FA5rfxJc94K1kNtxRby1hoHwi7YDyTWwx1KUR3FwskaF6HzCbZMz3zQwGnCqdiFeMTPV3YneTGS2YQPiuNYsSvtggWWMQpEJD4jXU7ZzEh/**,[eedff89a/48'/0'/0'/2']xpub6EhJvMneoLWAf8cuyLBLQiKiwh89RAmqXEqYeFuaCEHdHwxSRfzLrUxKXEBap7nZSHAYP7Jfq6gZmucotNzpMQ9Sb1nTqerqW8hrtmx6Y6o/**))\n/0/*,/1/*\nbc1qhs4u273g4azq7kqqpe6vh5wfhasfmrq7nheyzsnq77humd7rwtkqagvakf\n\n-   Coordinator encryption\n-   HMAC_KEY (hex):\n3d4c422806ba8964c9ee45070cd675c024d96648a0ddb4001325818c84951de2\n-   MAC (hex):\n734ce791b466861945e1ef6f74c63faec590793de54831f0036b28d08714b71a\n-   IV (hex) : 734ce791b466861945e1ef6f74c63fae\n-   CIPHERTEXT (hex):\n273cad18a5e1eff37dba6d850749594c9a3fd32b2069e8c69983ea269c5044b6bcaea26d9dbc8ad5d28bb8abfa02e3bfc7632fcc5c2b76e9abb1982ff11295858cfe44a8b97110ae970f58fff3fb6477f38ca9609eec78eedb1d640eaba489fd5e41e787b8d0bde48f1fa99cca641cabbee0f513fb1040cb73df10a57c9a34e4efcb069cd4c75467442c15d878ed9f40e3dffb98294931a6da4f444ae46f739b7fe002ce19fcfe71b05b9783d797ba45d568febbc8a2b0850da67f349d8567342352e1712c3d2a7ea1b2721df5efdb844431f0e5dcfa4acacb194c20785c9bb6dde90d64352fc913e9073b3b416be713bcc7632c821bbfddafa6199d471c54fb899f347f5fc706787ccaa82332dc8b93aeb3de3497d8e5c75f0f5d718c74bc6f8194fe999948e517f1c98398d9cb907d200f1d045394704b074dfb10e587f54fd78e95ef4bcbe77bf1376b390c3f47c91c12b2ed14073ea56bceab41f924302e62183c456b06d96b3da30439cb4320c764a0d6d1b3dabc06fc\n-   `my_multisig_wallet.dat`:\n734ce791b466861945e1ef6f74c63faec590793de54831f0036b28d08714b71a273cad18a5e1eff37dba6d850749594c9a3fd32b2069e8c69983ea269c5044b6bcaea26d9dbc8ad5d28bb8abfa02e3bfc7632fcc5c2b76e9abb1982ff11295858cfe44a8b97110ae970f58fff3fb6477f38ca9609eec78eedb1d640eaba489fd5e41e787b8d0bde48f1fa99cca641cabbee0f513fb1040cb73df10a57c9a34e4efcb069cd4c75467442c15d878ed9f40e3dffb98294931a6da4f444ae46f739b7fe002ce19fcfe71b05b9783d797ba45d568febbc8a2b0850da67f349d8567342352e1712c3d2a7ea1b2721df5efdb844431f0e5dcfa4acacb194c20785c9bb6dde90d64352fc913e9073b3b416be713bcc7632c821bbfddafa6199d471c54fb899f347f5fc706787ccaa82332dc8b93aeb3de3497d8e5c75f0f5d718c74bc6f8194fe999948e517f1c98398d9cb907d200f1d045394704b074dfb10e587f54fd78e95ef4bcbe77bf1376b390c3f47c91c12b2ed14073ea56bceab41f924302e62183c456b06d96b3da30439cb4320c764a0d6d1b3dabc06fc"
    },
    {
      "header": "Mode: `EXTENDED` Encryption {#mode_extended_encryption}",
      "content": "#### ROUND 1 {#round_1_4}\n\n-   Coordinator\n-   M-of-N: 2/3\n-   ADDRESS_TYPE: NESTED_SEGWIT\n-   TOKEN for Signer 1 (hex): 108a2360adb302774eb521daebbeda5e\n-   TOKEN (decimal): 21984902443033505423410071144203475550\n-   ENCRYPTION_KEY (hex):\n63dc1e57dfdc21fa11109d5088be01fb8078a383d2296925ad2b7612b7179777\n-   TOKEN for Signer 2 (hex): d3fabc873b98165254fe18a71b5335b0\n-   TOKEN (decimal): 281769005132501859744421970528095647152\n-   ENCRYPTION_KEY (hex):\n3dc860a53471ec03af14617fef60921cf215b45a9d684462fa65b9d804ad3ee7\n-   TOKEN for Signer 3 (hex): 78a7d5e7549453d719150de5459c9ce5\n-   TOKEN (decimal): 160378811550692397333855096016467696869\n-   ENCRYPTION_KEY (hex):\n62b90b4c08c03a0ee872e57aae73f9acfafb6cc09d20b5c9bc0bafaef33619db\n\n```{=html}\n<!-- -->\n```\n-   Signer 1\n-   MASTER_KEY_FINGERPRINT: 793cc70b\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/1\\'):\nL1ZEgZ4zNYxyNc8UyeqwyKW1UHVMp9sxwPgSi3s9SW8mc7KsiSwJ\n-   XPUB (m/48\\'/0\\'/0\\'/1\\'):\nxpub6ErVmcYYHmavsMgxEcTZyzN5sqth1ZyRpFNJC26ij1wYGC2SBKYrgt9yariSbn7HLRoZUvhUhmPfsRTPrdhhGFscpPZzmch6UTdmRP1aZUj\n-   Legacy signature\n-   `signer_1_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\n108a2360adb302774eb521daebbeda5e\n[793cc70b/48'/0'/0'/1']xpub6ErVmcYYHmavsMgxEcTZyzN5sqth1ZyRpFNJC26ij1wYGC2SBKYrgt9yariSbn7HLRoZUvhUhmPfsRTPrdhhGFscpPZzmch6UTdmRP1aZUj\nSigner 1 key\nILG47LpCtjoD9UxL87jo5QFqA90t8g9fDQp/KBojdKgPPGB1pMx2bf9hPdORNZIOdCc/2+Gs6AOs3BEK9ubIuBw=\n\n-   Signer 1 encryption\n-   HMAC_KEY (hex):\n1162cdace4ac9fcde1f96924b93714143d057a701de83ebaed248d1c9154f9fd\n-   MAC (hex):\nea12776c73de4bd5ea57c2d19eb8e0be856ac0d7f5651f7b74be4563d61ba5b1\n-   IV (hex) : ea12776c73de4bd5ea57c2d19eb8e0be\n-   CIPHERTEXT (hex):\na36f34232bff47a853092654a718fea4f5f57d6a1f3d38fede04e2414da12c90cefc24ef662f736886d9a7fd6e7db636ca47217803c86b7fbcebe4ad6b71cffc261069c135bd2b2430fb2b446ff0203df34fbbc6801243e8a930b9d0cd3a9b160b8dcdc9131ce6e97641e6314b3285ff341013f302e308c1b2eba7ced0103a8999fe2bd86f844392938e7926cd26d023b764d0b8ff92b2fbdf995884c738414b83563ef2a0050279bf46d0e8271ea5d6af8154847c5736129a7a83a35a3cc747b2be4b389886cb57456678353b60473ebc4ab85d9c9131a17a1e288717343d9008825b16c48d7e93927f37b530033192c67b70dec0411a3e5952d2525c7eb80721676e1a6299248c17f8078202f3bb0932e9f263b0ab\n-   `signer_1_key.dat`:\nea12776c73de4bd5ea57c2d19eb8e0be856ac0d7f5651f7b74be4563d61ba5b1a36f34232bff47a853092654a718fea4f5f57d6a1f3d38fede04e2414da12c90cefc24ef662f736886d9a7fd6e7db636ca47217803c86b7fbcebe4ad6b71cffc261069c135bd2b2430fb2b446ff0203df34fbbc6801243e8a930b9d0cd3a9b160b8dcdc9131ce6e97641e6314b3285ff341013f302e308c1b2eba7ced0103a8999fe2bd86f844392938e7926cd26d023b764d0b8ff92b2fbdf995884c738414b83563ef2a0050279bf46d0e8271ea5d6af8154847c5736129a7a83a35a3cc747b2be4b389886cb57456678353b60473ebc4ab85d9c9131a17a1e288717343d9008825b16c48d7e93927f37b530033192c67b70dec0411a3e5952d2525c7eb80721676e1a6299248c17f8078202f3bb0932e9f263b0ab\n\n```{=html}\n<!-- -->\n```\n-   Signer 2\n-   MASTER_KEY_FINGERPRINT: b3118e52\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/1\\'):\nL4SnPjcHszMg3Wi2YYxEYnzM2zFeFkFr5NcLZ18YQeyJwaSFbTud\n-   XPUB (m/48\\'/0\\'/0\\'/1\\'):\nxpub6Du5Jn6eYZE96ccmAc1ZTFPzdnzrvqfG4mpamDun2qZYKywoiQJMCbS3kWWMr6U3XW6s125RLsaPABWgv2yA749ieaMe67FxkTjMsbcxCch\n-   Legacy signature\n-   `signer_2_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\nd3fabc873b98165254fe18a71b5335b0\n[b3118e52/48'/0'/0'/1']xpub6Du5Jn6eYZE96ccmAc1ZTFPzdnzrvqfG4mpamDun2qZYKywoiQJMCbS3kWWMr6U3XW6s125RLsaPABWgv2yA749ieaMe67FxkTjMsbcxCch\nSigner 2 key\nIDK4d/oO0pgfrwRu4Zb8vqlPEmJb9aKT1K2CCnI3RKepVAKs3fZsBrypcCdQfUy1TG/3O5vAR3gjldxcCA1Wzg8=\n\n-   Signer 2 encryption\n-   HMAC_KEY (hex):\n43a4e704bd1bade703023004b00290f1a7b005474a581d869a217068eedf3f57\n-   MAC (hex):\n4a3ff970d027010e83b4fbf2845a23907a301b3df692a9265e2ca679697ac718\n-   IV (hex) : 4a3ff970d027010e83b4fbf2845a2390\n-   CIPHERTEXT (hex):\nc8f4a6a6714eff90aa48cbefe6750c2ee3cc72182eb455e964f0ba59ada3ecd758c29f0fab7e33aaa82a340a18d9c793ddab09dc7e714864faac1ecea370d4f102533b739da38aa0491433f35eadec08f203685f04d1f6ec35d397d99e4f8096a5691075e3f54fd9ff58faf947f276bbe1031f827b274bd2f60fcb526add7058889104b189d7da22ac7be1f7ddd380bbebd5c6983a8a3c5fa86913e3d23c40935072ce03d9bdeb07791dc836d44b4d4c62f364d0e4f3580369ea8f6ebb774b7fda4a7ac6f5ae6b2f52b10cd71bdf3cdb5889e77d5eb1f2f647b798cdd6b3e5b964c9265daea3668d7e4cb53f724151923da1a87bbcd2abd8b164de474d865c51af69885431d26f88a5c8eea7d0dfdb52ca622017808a\n-   `signer_2_key.dat`:\n4a3ff970d027010e83b4fbf2845a23907a301b3df692a9265e2ca679697ac718c8f4a6a6714eff90aa48cbefe6750c2ee3cc72182eb455e964f0ba59ada3ecd758c29f0fab7e33aaa82a340a18d9c793ddab09dc7e714864faac1ecea370d4f102533b739da38aa0491433f35eadec08f203685f04d1f6ec35d397d99e4f8096a5691075e3f54fd9ff58faf947f276bbe1031f827b274bd2f60fcb526add7058889104b189d7da22ac7be1f7ddd380bbebd5c6983a8a3c5fa86913e3d23c40935072ce03d9bdeb07791dc836d44b4d4c62f364d0e4f3580369ea8f6ebb774b7fda4a7ac6f5ae6b2f52b10cd71bdf3cdb5889e77d5eb1f2f647b798cdd6b3e5b964c9265daea3668d7e4cb53f724151923da1a87bbcd2abd8b164de474d865c51af69885431d26f88a5c8eea7d0dfdb52ca622017808a\n\n```{=html}\n<!-- -->\n```\n-   Signer 3\n-   MASTER_KEY_FINGERPRINT: 842bd2ed\n-   PRIVATE_KEY (m/48\\'/0\\'/0\\'/1\\'):\nL1ehZHpo2UFHc1yaBWDU4bKVycUwcU2TESm92wbfq6xK6qpZZJP6\n-   XPUB (m/48\\'/0\\'/0\\'/1\\'):\nxpub6Ex81KopPkEt9hJiWHabYy8LNsSR4A7sUQoFBk9dR8XxHrr4p9HrYWN3NCf5uwfopHnQkCG7FYnZMztKbtRtbh6tzZC4xtHPbmVVxRSN7ic\n-   Legacy signature\n-   `signer_3_key.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\n78a7d5e7549453d719150de5459c9ce5\n[842bd2ed/48'/0'/0'/1']xpub6Ex81KopPkEt9hJiWHabYy8LNsSR4A7sUQoFBk9dR8XxHrr4p9HrYWN3NCf5uwfopHnQkCG7FYnZMztKbtRtbh6tzZC4xtHPbmVVxRSN7ic\nSigner 3 key\nIL77mML0xo/O9dJn0T5EpQLuyRPPrdpgVJbtsdAugW5iX0MQ3Ci0f8jVnXu68Xm07CYjYGKX8af72jmkQKhNud0=\n\n-   Signer 3 encryption\n-   HMAC_KEY (hex):\nab93ce7bf0f91c62a66d00ea9bf5e5c00b854ee2cfc2fb06f6eeff738abcdc26\n-   MAC (hex):\ne82cfcccbd4bd4d3b76e28133eecd13f7362f4a8b4c4baa3e5f6ba2dfb4d69b8\n-   IV (hex) : e82cfcccbd4bd4d3b76e28133eecd13f\n-   CIPHERTEXT (hex):\nb44433f0b564ec35a1e71371f25844088084b47402c90d52fee7237167b58a60a28c234af9123e104773136e8446d799541c8566882787caee7cd1fa8628aba63aa9e9d7cca0ddee92f96dd881535b19a131a1f487a1909e42d62945fd0ba08dacd7dc09a22ffe47e0410b8b85df92e4a8bbf9b46f0062da02e3ae94144a00bae917acc1246d8d1a4dca105708f55379caefef9d4c152f56b65ab4bd7b48f60233f57ba6d705387c79aeaa2a279e3314004bf16fcd7e7d2adef34b0ab3c22bc5461f2c09dce69065605e4fb96958c55984391712b3547e3914ad4ecca2c088be280dfcfe374a112515674aeca57b885e81dbef6a353ca387f4514db3158eb69f0d2725d42ad8102c05c26ad501d48b889c624035ead4\n-   `signer_3_key.dat`:\ne82cfcccbd4bd4d3b76e28133eecd13f7362f4a8b4c4baa3e5f6ba2dfb4d69b8b44433f0b564ec35a1e71371f25844088084b47402c90d52fee7237167b58a60a28c234af9123e104773136e8446d799541c8566882787caee7cd1fa8628aba63aa9e9d7cca0ddee92f96dd881535b19a131a1f487a1909e42d62945fd0ba08dacd7dc09a22ffe47e0410b8b85df92e4a8bbf9b46f0062da02e3ae94144a00bae917acc1246d8d1a4dca105708f55379caefef9d4c152f56b65ab4bd7b48f60233f57ba6d705387c79aeaa2a279e3314004bf16fcd7e7d2adef34b0ab3c22bc5461f2c09dce69065605e4fb96958c55984391712b3547e3914ad4ecca2c088be280dfcfe374a112515674aeca57b885e81dbef6a353ca387f4514db3158eb69f0d2725d42ad8102c05c26ad501d48b889c624035ead4"
    },
    {
      "header": "ROUND 2 {#round_2_4}",
      "content": "-   Coordinator\n-   `my_multisig_wallet.bsms`:\n\n```{=html}\n<!-- -->\n```\nBSMS 1.0\nsh(wsh(multi(2,[793cc70b/48'/0'/0'/1']xpub6ErVmcYYHmavsMgxEcTZyzN5sqth1ZyRpFNJC26ij1wYGC2SBKYrgt9yariSbn7HLRoZUvhUhmPfsRTPrdhhGFscpPZzmch6UTdmRP1aZUj/**,[b3118e52/48'/0'/0'/1']xpub6Du5Jn6eYZE96ccmAc1ZTFPzdnzrvqfG4mpamDun2qZYKywoiQJMCbS3kWWMr6U3XW6s125RLsaPABWgv2yA749ieaMe67FxkTjMsbcxCch/**,[842bd2ed/48'/0'/0'/1']xpub6Ex81KopPkEt9hJiWHabYy8LNsSR4A7sUQoFBk9dR8XxHrr4p9HrYWN3NCf5uwfopHnQkCG7FYnZMztKbtRtbh6tzZC4xtHPbmVVxRSN7ic/**)))\n/0/*,/1/*\n3GzMtFXahiu4TpGNGFc4bHMvAcvz5vVQrT\n\n-   Send to Signer 1:\n-   HMAC_KEY (hex):\n1162cdace4ac9fcde1f96924b93714143d057a701de83ebaed248d1c9154f9fd\n-   MAC (hex):\n01bf557b6d44b3fbf07f8ec155cbdec42d85d856e174342563dd83b40ad7c025\n-   IV (hex) : 01bf557b6d44b3fbf07f8ec155cbdec4\n-   CIPHERTEXT (hex):\n617ed25b4b8fd88b806cbebcc1731b071465514a805f7ba2de60e291bc9493f31aa0f9b0665ba822cf9a2e21c02649b5c3f7dbad317ae898292cb6fe992520f68c0ebe9d1434b348af10453f1be0a392a616d43ba21e5e7fa3c995dce54db947fe5dbad4a9a77f37b3aef58c54ee3e496c8312d3033359aed0de8cf28b82035ee7a38c9b23c9d95682fb15936bf2247546d2ba9b3ada605f5c89f0a3bbaa86cb4b5dded9a65004912c0afbbfd01f0115447f5625e8523f9de16165d32c4b21103d8ac965e2f7e17641ee1a8c5902e8dbb461c6c7d05141f7bba66b8b3608037fb251b55fa461c9441c6427921545a34a1798127d5bf9cc92423f7e62c769e232c65db8cc5124577012d49941143c3b4758212a8afa0475c9b3597da2e99d585039339b7d73611aa277878d212875051683053db9c630391e0b32356523e9fa8a58a334e16fe6650472f336ddaa8c587992b6c0c0e480b680261579a11cf9d036614abc113dde53653273f5ce82ea0bc10e38ca52ac66838aa49ff46c3a7d5096db439c15d3c2e8de55e4ac7315a57eb9997f219c378af86c858867ce583ed84e4d9c68aecfbca9ebff16b0ac91531125e273b215db688ffe52c8033eb78914b87c0fa2001c52e90c92765712e50384ddcf4d0953ac3cc8137abcb2a85d603a6cc207472677\n-   `my_multisig_wallet_for_signer_1.dat`:\n01bf557b6d44b3fbf07f8ec155cbdec42d85d856e174342563dd83b40ad7c025617ed25b4b8fd88b806cbebcc1731b071465514a805f7ba2de60e291bc9493f31aa0f9b0665ba822cf9a2e21c02649b5c3f7dbad317ae898292cb6fe992520f68c0ebe9d1434b348af10453f1be0a392a616d43ba21e5e7fa3c995dce54db947fe5dbad4a9a77f37b3aef58c54ee3e496c8312d3033359aed0de8cf28b82035ee7a38c9b23c9d95682fb15936bf2247546d2ba9b3ada605f5c89f0a3bbaa86cb4b5dded9a65004912c0afbbfd01f0115447f5625e8523f9de16165d32c4b21103d8ac965e2f7e17641ee1a8c5902e8dbb461c6c7d05141f7bba66b8b3608037fb251b55fa461c9441c6427921545a34a1798127d5bf9cc92423f7e62c769e232c65db8cc5124577012d49941143c3b4758212a8afa0475c9b3597da2e99d585039339b7d73611aa277878d212875051683053db9c630391e0b32356523e9fa8a58a334e16fe6650472f336ddaa8c587992b6c0c0e480b680261579a11cf9d036614abc113dde53653273f5ce82ea0bc10e38ca52ac66838aa49ff46c3a7d5096db439c15d3c2e8de55e4ac7315a57eb9997f219c378af86c858867ce583ed84e4d9c68aecfbca9ebff16b0ac91531125e273b215db688ffe52c8033eb78914b87c0fa2001c52e90c92765712e50384ddcf4d0953ac3cc8137abcb2a85d603a6cc207472677\n\n```{=html}\n<!-- -->\n```\n-   Send to Signer 2:\n-   HMAC_KEY (hex):\n43a4e704bd1bade703023004b00290f1a7b005474a581d869a217068eedf3f57\n-   MAC (hex):\n974ba77900c43c463dadaa6eaf24aaeb1b25b443cf155229b719bcbf8b343092\n-   IV (hex) : 974ba77900c43c463dadaa6eaf24aaeb\n-   CIPHERTEXT (hex):\n86288c97a6341974a35015f97fbbc8db7655639c839fc438706f82fce36a82dd17e2d4d4a674516c4fc5c3a33d6097dd8fc5c6605018946741ed9f58d8fe530a808f16f0dd705cacfd273e34a158bd7566774dd31506b8280e448fabb72d0e7dfc05cee1142b61921dfaf0b0039d885cc0aa76c429025efc2ba49a8af15b58e75a5a83ba4838a9a4c9f13725f5aecefd8511513d93797f37b93150b9dca725685883188e39142dd8d3cf4b617c7936bdb3875415bbf6dfb2fe1a39ae2aed9fd2909aebd0355a5cc9a55bcb84048c851a1873948e495180f336edeb63f54bcf83feaa4d2453251260e24293e49815c2369c1c045083c412c973987fd7c9296a71cda424823ed32380ba442394500b7d2d2335818099090aaf08ca4e180869c546f58da4cb4ff0f95b796a35c40ea455e2ddd3e08bc494ffddc706aaf4d479f4f359e6a89a90df7c9b8f23cab355855a72b90795a0db83a96bce0dd4f77e3f58c0957b4ffe9663251565098e6c31fd4bbf3e1295faaff05e29912d9c37cb944da379a9b2193b466910d05a681e53a2dbe5aa18a2b4874153fe36d8a1aa4cc6e612bd6dbc9abb8e1e61b927fc5458d8e1be9536cd462e4c37672af7928c39e94bdc124a2da7b1bd3cad2cfe559adc33e62eb45bff89db8a47a72dda4f49f21c01a9432f4802a1\n-   `my_multisig_wallet_for_signer_2.dat`:\n974ba77900c43c463dadaa6eaf24aaeb1b25b443cf155229b719bcbf8b34309286288c97a6341974a35015f97fbbc8db7655639c839fc438706f82fce36a82dd17e2d4d4a674516c4fc5c3a33d6097dd8fc5c6605018946741ed9f58d8fe530a808f16f0dd705cacfd273e34a158bd7566774dd31506b8280e448fabb72d0e7dfc05cee1142b61921dfaf0b0039d885cc0aa76c429025efc2ba49a8af15b58e75a5a83ba4838a9a4c9f13725f5aecefd8511513d93797f37b93150b9dca725685883188e39142dd8d3cf4b617c7936bdb3875415bbf6dfb2fe1a39ae2aed9fd2909aebd0355a5cc9a55bcb84048c851a1873948e495180f336edeb63f54bcf83feaa4d2453251260e24293e49815c2369c1c045083c412c973987fd7c9296a71cda424823ed32380ba442394500b7d2d2335818099090aaf08ca4e180869c546f58da4cb4ff0f95b796a35c40ea455e2ddd3e08bc494ffddc706aaf4d479f4f359e6a89a90df7c9b8f23cab355855a72b90795a0db83a96bce0dd4f77e3f58c0957b4ffe9663251565098e6c31fd4bbf3e1295faaff05e29912d9c37cb944da379a9b2193b466910d05a681e53a2dbe5aa18a2b4874153fe36d8a1aa4cc6e612bd6dbc9abb8e1e61b927fc5458d8e1be9536cd462e4c37672af7928c39e94bdc124a2da7b1bd3cad2cfe559adc33e62eb45bff89db8a47a72dda4f49f21c01a9432f4802a1\n\n```{=html}\n<!-- -->\n```\n-   Send to Signer 3:\n-   HMAC_KEY (hex):\nab93ce7bf0f91c62a66d00ea9bf5e5c00b854ee2cfc2fb06f6eeff738abcdc26\n-   MAC (hex):\nbb3c93b67d758f244de7ee73e5e61261cea6dff5b3852df8faf265cdf1c73dae\n-   IV (hex) : bb3c93b67d758f244de7ee73e5e61261\n-   CIPHERTEXT (hex):\n7ac33bd9719a3cef6c68e09b3c9677565418933f188bbe50dc70f46329706732fe28ab230468e2a8798d3fbf641867d5b3322113204a372e7650ed06cf94d6df5cc7425b1b3a07690a32e12fd9cdad2c9f42d496c1b02215a7d8d63565aa4935bb2b087af39eebc02d4a2d30a4dbf1e72b9a0dab11473c7254ecf9065eb4f9d80a164c489d5fdae0d15d97b6100b79c3999b91341dfb4f599f738d4d631ae413c17b55daa09a67cb34b40d89c26f0e95ddfbf416033f869da32e502815d720bb342ec1c0e5c6910c598f32162016229cd37ea030b4d3b60f560105abb75531dc960ddf6830c26604c67c2da05b8adc45297dda58b2da4671104969b819cdf1c362bc20d7bdfe4a2fbdb79b4a69e285434d991c269e3d23ce3d95675a0acbec2cae04a310581148d3422c1c0a621fb6d79ecac1743b0e76837389b67cd4734ec5ab560c43a183de35fa98834e1f347a0c0c9b14273b76233f55f04553efcde873de92d766f3cdc5e56bc649bf0cc4951f051619ee9b931cd3872044b0e62ea2c2dacad978dbb8df3afa0b9386535278c295c6a30a56950e57f805770568e937ffafbadb226120991d5ec10effa9f4334800010d141a2ddddc00ac743efa821af37f69840487e4db48036c1e0730788cddbca2f68b3769ec6989d76161e6605af50651b6e86e\n-   `my_multisig_wallet_for_signer_3.dat`:\nbb3c93b67d758f244de7ee73e5e61261cea6dff5b3852df8faf265cdf1c73dae7ac33bd9719a3cef6c68e09b3c9677565418933f188bbe50dc70f46329706732fe28ab230468e2a8798d3fbf641867d5b3322113204a372e7650ed06cf94d6df5cc7425b1b3a07690a32e12fd9cdad2c9f42d496c1b02215a7d8d63565aa4935bb2b087af39eebc02d4a2d30a4dbf1e72b9a0dab11473c7254ecf9065eb4f9d80a164c489d5fdae0d15d97b6100b79c3999b91341dfb4f599f738d4d631ae413c17b55daa09a67cb34b40d89c26f0e95ddfbf416033f869da32e502815d720bb342ec1c0e5c6910c598f32162016229cd37ea030b4d3b60f560105abb75531dc960ddf6830c26604c67c2da05b8adc45297dda58b2da4671104969b819cdf1c362bc20d7bdfe4a2fbdb79b4a69e285434d991c269e3d23ce3d95675a0acbec2cae04a310581148d3422c1c0a621fb6d79ecac1743b0e76837389b67cd4734ec5ab560c43a183de35fa98834e1f347a0c0c9b14273b76233f55f04553efcde873de92d766f3cdc5e56bc649bf0cc4951f051619ee9b931cd3872044b0e62ea2c2dacad978dbb8df3afa0b9386535278c295c6a30a56950e57f805770568e937ffafbadb226120991d5ec10effa9f4334800010d141a2ddddc00ac743efa821af37f69840487e4db48036c1e0730788cddbca2f68b3769ec6989d76161e6605af50651b6e86e"
    },
    {
      "header": "Acknowledgement",
      "content": "Special thanks to Pavol Rusnak, Dmitry Petukhov, Christopher Allen,\nCraig Raw, Robert Spigler, Gregory Sanders, Ta Tat Tai, Michael Flaxman,\nPieter Wuille, Salvatore Ingala, Andrew Chow and others for their\nfeedback on the specification."
    },
    {
      "header": "References",
      "content": "Related mailing list threads:\n\n-   <https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-February/018385.html>\n-   <https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018732.html>"
    }
  ]
}